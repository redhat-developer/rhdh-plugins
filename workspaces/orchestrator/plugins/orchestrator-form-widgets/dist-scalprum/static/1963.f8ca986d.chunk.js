"use strict";(self.webpackChunkred_hat_developer_hub_backstage_plugin_orchestrator_form_widgets=self.webpackChunkred_hat_developer_hub_backstage_plugin_orchestrator_form_widgets||[]).push([[1963],{41963:(e,t,n)=>{n.r(t),n.d(t,{AnalyticsContext:()=>c,FeatureFlagState:()=>D,SessionState:()=>R,alertApiRef:()=>_,analyticsApiRef:()=>l,appThemeApiRef:()=>F,atlassianAuthApiRef:()=>S,attachComponentData:()=>B,bitbucketAuthApiRef:()=>E,bitbucketServerAuthApiRef:()=>C,configApiRef:()=>$,createApiFactory:()=>m,createApiRef:()=>p.y,createComponentExtension:()=>X,createExternalRouteRef:()=>pe,createPlugin:()=>ne,createReactExtension:()=>J,createRoutableExtension:()=>Q,createRouteRef:()=>ie,createSubRouteRef:()=>ce,discoveryApiRef:()=>j,errorApiRef:()=>G.m,featureFlagsApiRef:()=>P,fetchApiRef:()=>V,getComponentData:()=>L,githubAuthApiRef:()=>v,gitlabAuthApiRef:()=>w,googleAuthApiRef:()=>y,identityApiRef:()=>I,microsoftAuthApiRef:()=>A,oauthRequestApiRef:()=>O,oktaAuthApiRef:()=>b,oneloginAuthApiRef:()=>x,openshiftAuthApiRef:()=>k,storageApiRef:()=>T,useAnalytics:()=>g,useApi:()=>u.gf,useApiHolder:()=>u.Q2,useApp:()=>M,useElementFilter:()=>ee,useRouteRef:()=>q,useRouteRefParams:()=>le,vmwareCloudAuthApiRef:()=>N,withApis:()=>u.wV});var o=n(31085),r=n(64218),i=n(95478);const a=(0,r.createVersionedContext)("analytics-context"),s=()=>{const e=(0,i.useContext)(a);if(void 0===e)return{routeRef:"unknown",pluginId:"root",extension:"App"};const t=e.atVersion(1);if(void 0===t)throw new Error("No context found for version 1.");return t},c=e=>{const{attributes:t,children:n}=e,i={...s(),...t},c=(0,r.createVersionedValueMap)({1:i});return(0,o.jsx)(a.Provider,{value:c,children:n})};var u=n(18139),p=n(28967);const l=(0,p.y)({id:"core.analytics"}),d=(0,r.getOrCreateGlobalSingleton)("core-plugin-api:analytics-tracker-events",(()=>({mostRecentGatheredNavigation:void 0,mostRecentRoutableExtensionRender:void 0,beforeUnloadRegistered:!1}))),h="_ROUTABLE-EXTENSION-RENDERED";class f{constructor(e,t={routeRef:"unknown",pluginId:"root",extension:"App"}){this.analyticsApi=e,this.context=t,d.beforeUnloadRegistered||(addEventListener("beforeunload",(()=>{d.mostRecentGatheredNavigation&&(this.analyticsApi.captureEvent({...d.mostRecentGatheredNavigation,...d.mostRecentRoutableExtensionRender}),d.mostRecentGatheredNavigation=void 0,d.mostRecentRoutableExtensionRender=void 0)}),{once:!0,passive:!0}),d.beforeUnloadRegistered=!0)}setContext(e){this.context=e}captureEvent(e,t,{value:n,attributes:o}={}){const{_routeNodeType:r,...i}=this.context;if(e!==h){if(d.mostRecentGatheredNavigation){try{this.analyticsApi.captureEvent({...d.mostRecentGatheredNavigation,...d.mostRecentRoutableExtensionRender})}catch(e){console.warn("Error during analytics event capture. %o",e)}d.mostRecentGatheredNavigation=void 0,d.mostRecentRoutableExtensionRender=void 0}if("navigate"!==e||"gathered"!==r||"root"!==i.pluginId)try{this.analyticsApi.captureEvent({action:e,subject:t,value:n,attributes:o,context:i})}catch(e){console.warn("Error during analytics event capture. %o",e)}else d.mostRecentGatheredNavigation={action:e,subject:t,value:n,attributes:o,context:i}}else d.mostRecentGatheredNavigation&&(d.mostRecentRoutableExtensionRender={context:{...i,extension:"App"}})}}function g(){const e=(0,i.useRef)(null),t=s(),n=function(){try{return(0,u.gf)(l)}catch{return{captureEvent:()=>{}}}}(),o=(null===e.current&&(e.current=new f(n)),e.current);return o.setContext(t),o}function m(e,t){return"id"in e?{api:e,deps:{},factory:()=>t}:e}var R=(e=>(e.SignedIn="SignedIn",e.SignedOut="SignedOut",e))(R||{});const y=(0,p.y)({id:"core.auth.google"}),v=(0,p.y)({id:"core.auth.github"}),b=(0,p.y)({id:"core.auth.okta"}),w=(0,p.y)({id:"core.auth.gitlab"}),A=(0,p.y)({id:"core.auth.microsoft"}),x=(0,p.y)({id:"core.auth.onelogin"}),E=(0,p.y)({id:"core.auth.bitbucket"}),C=(0,p.y)({id:"core.auth.bitbucket-server"}),S=(0,p.y)({id:"core.auth.atlassian"}),N=(0,p.y)({id:"core.auth.vmware-cloud"}),k=(0,p.y)({id:"core.auth.openshift"}),_=(0,p.y)({id:"core.alert"}),F=(0,p.y)({id:"core.apptheme"}),$=(0,p.y)({id:"core.config"}),j=(0,p.y)({id:"core.discovery"});var G=n(24453),D=(e=>(e[e.None=0]="None",e[e.Active=1]="Active",e))(D||{});const P=(0,p.y)({id:"core.featureflags"}),V=(0,p.y)({id:"core.fetch"}),I=(0,p.y)({id:"core.identity"}),O=(0,p.y)({id:"core.oauthrequest"}),T=(0,p.y)({id:"core.storage"}),M=()=>{const e=(0,r.useVersionedContext)("app-context");if(!e)throw new Error("App context is not available");const t=e.atVersion(1);if(!t)throw new Error("AppContext v1 not available");return t},z=(0,r.getOrCreateGlobalSingleton)("component-data-store",(()=>new WeakMap)),W="__backstage_data";function B(e,t,n){const o=e;let r=o[W]??z.get(e);if(r||(r={map:new Map},Object.defineProperty(o,W,{enumerable:!1,configurable:!0,writable:!1,value:r}),z.set(e,r)),r.map.has(t)){const n=e.displayName||e.name;throw new Error(`Attempted to attach duplicate data "${t}" to component "${n}"`)}r.map.set(t,n)}function L(e,t){if(!e)return;const n=e.type;if(!n)return;const o=n[W]??z.get(n);return o?o.map.get(t):void 0}var U=n(42469);function q(e){const{pathname:t}=(0,U.useLocation)(),n=(0,r.useVersionedContext)("routing-context");if(!n)throw new Error("Routing context is not available");const o=n.atVersion(1),a=(0,i.useMemo)((()=>o&&o.resolve(e,{pathname:t})),[o,e,t]);if(!n)throw new Error("useRouteRef used outside of routing context");if(!o)throw new Error("RoutingContext v1 not available");const s="optional"in e&&e.optional;if(!a&&!s)throw new Error(`No path for ${e}`);return a}class H extends i.Component{static getDerivedStateFromError(e){return{error:e}}state={error:void 0};handleErrorReset=()=>{this.setState({error:void 0})};render(){const{error:e}=this.state,{app:t,plugin:n}=this.props,{ErrorBoundaryFallback:r}=t.getComponents();return e?(0,o.jsx)(r,{error:e,resetError:this.handleErrorReset,plugin:n}):this.props.children}}var K=n(57556);function Q(e){const{component:t,mountPoint:n,name:r}=e;return J({component:{lazy:()=>t().then((e=>{const t=t=>{const r=g();try{q(n)}catch(e){if("object"==typeof e&&null!==e){const{message:t}=e;if("string"==typeof t&&t.startsWith("No path for "))throw new Error(`Routable extension component with mount point ${n} was not discovered in the app element tree. Routable extension components may not be rendered by other components and must be directly available as an element within the App provider component.`)}throw e}return(0,i.useEffect)((()=>{r.captureEvent(h,"")}),[r]),(0,o.jsx)(e,{...t})},a=r||e.displayName||e.name||"LazyComponent";return t.displayName=`RoutableExtension(${a})`,t}))},data:{"core.mountPoint":n},name:r})}function X(e){const{component:t,name:n}=e;return J({component:t,name:n})}function J(e){const{data:t={},name:n}=e;let r;if(n||console.warn("Declaring extensions without name is DEPRECATED. Make sure that all usages of createReactExtension, createComponentExtension and createRoutableExtension provide a name."),"lazy"in e.component){const t=e.component.lazy;r=(0,i.lazy)((()=>t().then((e=>({default:e})),(e=>{const t=n?` of the ${n} extension`:"";throw new K.HK(`Failed lazy loading${t}, try to reload the page`,e)}))))}else r=e.component.sync;const a=n||r.displayName||r.name||"Component";return{expose(e){const s=a=>{const s=M(),{Progress:u}=s.getComponents(),p=t?.["core.mountPoint"];return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)(u,{}),children:(0,o.jsx)(H,{app:s,plugin:e,children:(0,o.jsx)(c,{attributes:{pluginId:e.getId(),...n&&{extension:n},...p&&{routeRef:p.id}},children:(0,o.jsx)(r,{...a})})})})};B(s,"core.plugin",e),B(s,"core.extensionName",n);for(const[e,n]of Object.entries(t))B(s,e,n);return s.displayName=`Extension(${a})`,s}}}function Y(e,t,n,o){return i.Children.toArray(e).flatMap((e=>{if(!(0,i.isValidElement)(e))return[];if(e.type===i.Fragment)return Y(e.props.children,t,n,o);if(L(e,"core.featureFlagged")){const r=e.props;return("with"in r?t.isActive(r.with):!t.isActive(r.without))?Y(e.props.children,t,n,o):[]}if(void 0===n||n(e))return[e];if(o)throw new Error(o);return Y(e.props.children,t,n,o)}))}class Z{constructor(e,t){this.node=e,this.featureFlagsApi=t}selectByComponentData(e){const t=Y(this.node,this.featureFlagsApi,(t=>void 0!==L(t,e.key)),e.withStrictError);return new Z(t,this.featureFlagsApi)}findComponentData(e){return Y(this.node,this.featureFlagsApi,(t=>void 0!==L(t,e.key))).map((t=>L(t,e.key))).filter((e=>void 0!==e))}getElements(){return Y(this.node,this.featureFlagsApi)}}function ee(e,t,n=[]){const o=(0,u.gf)(P),r=new Z(e,o);return(0,i.useMemo)((()=>t(r)),[e,...n])}class te{constructor(e){this.config=e}getId(){return this.config.id}getApis(){return this.config.apis??[]}getFeatureFlags(){return this.config.featureFlags?.slice()??[]}get routes(){return this.config.routes??{}}get externalRoutes(){return this.config.externalRoutes??{}}provide(e){return e.expose(this)}toString(){return`plugin{${this.config.id}}`}}function ne(e){return new te(e)}const oe=(0,r.getOrCreateGlobalSingleton)("route-ref-type",(()=>Symbol("route-ref-type")));class re{constructor(e,t){this.id=e,this.params=t}[oe]="absolute";get title(){return this.id}toString(){return`routeRef{type=absolute,id=${this.id}}`}}function ie(e){return new re(e.id,e.params??[])}const ae=/^\w+$/;class se{constructor(e,t,n,o){this.id=e,this.path=t,this.parent=n,this.params=o}[oe]="sub";toString(){return`routeRef{type=sub,id=${this.id}}`}}function ce(e){const{id:t,path:n,parent:o}=e,r=n.split("/").filter((e=>e.startsWith(":"))).map((e=>e.substring(1))),i=[...o.params,...r];if(o.params.some((e=>r.includes(e))))throw new Error("SubRouteRef may not have params that overlap with its parent");if(!n.startsWith("/"))throw new Error(`SubRouteRef path must start with '/', got '${n}'`);if(n.endsWith("/"))throw new Error(`SubRouteRef path must not end with '/', got '${n}'`);for(const e of r)if(!ae.test(e))throw new Error(`SubRouteRef path has invalid param, got '${e}'`);return new se(t,n,o,i)}class ue{constructor(e,t,n,o){this.id=e,this.params=t,this.optional=n,this.defaultTarget=o}[oe]="external";toString(){return`routeRef{type=external,id=${this.id}}`}getDefaultTarget(){return this.defaultTarget}}function pe(e){return new ue(e.id,e.params??[],Boolean(e.optional),e?.defaultTarget)}function le(e){return(0,U.useParams)()}}}]);
//# sourceMappingURL=1963.f8ca986d.chunk.js.map