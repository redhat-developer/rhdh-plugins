# API Usage

The Orchestrator plugin provides comprehensive API functionality for integrating with workflows programmatically.

## Orchestrator API

The backend plugin provides OpenAPI `v2` endpoints definition.

The OpenAPI specification file is available in the [openapi spec file](../plugins/orchestrator-common/src/openapi/openapi.yaml).

Documentation is available in the autogenerated [documentation](../plugins/orchestrator-common/src/generated/docs/markdown/README.md)

## TypeScript Client

The plugin provides an auto-generated typescript client that can be used to call the API. To use it include the `@red-hat-developer-hub/backstage-plugin-orchestrator-common` plugin in your project.

You can see in the [OrchestratorClient.ts](../plugins/orchestrator/src/api/OrchestratorClient.ts#L59) how the client can be used.

### Example Usage

```typescript
import { OrchestratorApi } from '@red-hat-developer-hub/backstage-plugin-orchestrator-common';

// Initialize the client
const orchestratorApi = new OrchestratorApi({
  baseUrl: 'http://your-backstage-backend',
  // ... other configuration
});

// Execute a workflow
const result = await orchestratorApi.executeWorkflow({
  workflowId: 'my-workflow',
  parameters: {
    // workflow input parameters
  },
});

// Get workflow instances
const instances = await orchestratorApi.getWorkflowInstances();

// Get workflow definition
const definition = await orchestratorApi.getWorkflowDefinition('my-workflow');
```

## Scaffolder Backend Module

To call workflows from a [Backstage software template](https://backstage.io/docs/features/software-templates/), additional [custom actions](https://backstage.io/docs/features/software-templates/writing-custom-actions) need to be deployed.

Their implementation lives in the [plugins/scaffolder-backend-module-orchestrator](../plugins/scaffolder-backend-module-orchestrator) module.

### Available Actions

- `orchestrator:workflow:run` - Execute a workflow
- `orchestrator:workflow:get_params` - Get workflow parameters

For detailed information about these actions, see the [scaffolder-backend-module-orchestrator README](../plugins/scaffolder-backend-module-orchestrator/README.md).

## Authentication in Workflows

Workflows that call external APIs requiring authentication can request tokens in the input schema â€” [see auth.md](auth.md) for details.

## API Reference

- **[OpenAPI Specification](../plugins/orchestrator-common/src/openapi/openapi.yaml)** - Complete API definition
- **[Auto-generated Documentation](../plugins/orchestrator-common/src/generated/docs/markdown/README.md)** - Detailed API docs
- **[Scaffolder Actions](../plugins/scaffolder-backend-module-orchestrator/README.md)** - Template integration actions
