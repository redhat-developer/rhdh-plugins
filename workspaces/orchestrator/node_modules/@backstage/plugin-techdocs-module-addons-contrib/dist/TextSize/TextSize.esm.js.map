{"version":3,"file":"TextSize.esm.js","sources":["../../src/TextSize/TextSize.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ChangeEvent,\n  MouseEvent,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n} from 'react';\n\nimport {\n  withStyles,\n  makeStyles,\n  useTheme,\n  Box,\n  MenuItem,\n  ListItemText,\n  Slider,\n  IconButton,\n  Typography,\n  Theme,\n} from '@material-ui/core';\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\n\nimport { useShadowRootElements } from '@backstage/plugin-techdocs-react';\n\nconst boxShadow =\n  '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)';\n\nconst StyledSlider = withStyles(theme => ({\n  root: {\n    height: 2,\n    padding: '15px 0',\n  },\n  thumb: {\n    height: 18,\n    width: 18,\n    backgroundColor: theme.palette.common.white,\n    boxShadow: boxShadow,\n    marginTop: -9,\n    marginLeft: -9,\n    '&:focus, &:hover, &$active': {\n      boxShadow:\n        '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)',\n      // Reset on touch devices, it doesn't add specificity\n      '@media (hover: none)': {\n        boxShadow: boxShadow,\n      },\n    },\n  },\n  active: {},\n  valueLabel: {\n    top: '100%',\n    left: '50%',\n    transform: 'scale(1) translate(-50%, -5px) !important',\n    '& *': {\n      color: theme.palette.textSubtle,\n      fontSize: theme.typography.caption.fontSize,\n      background: 'transparent',\n    },\n  },\n  track: {\n    height: 2,\n  },\n  rail: {\n    height: 2,\n    opacity: 0.5,\n  },\n  mark: {\n    height: 10,\n    width: 1,\n    marginTop: -4,\n  },\n  markActive: {\n    opacity: 1,\n    backgroundColor: 'currentColor',\n  },\n}))(Slider);\n\nconst settings = {\n  key: 'techdocs.addons.settings.textsize',\n  defaultValue: 100,\n};\n\nconst marks = [\n  {\n    value: 90,\n  },\n  {\n    value: 100,\n  },\n  {\n    value: 115,\n  },\n  {\n    value: 130,\n  },\n  {\n    value: 150,\n  },\n];\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    color: theme.palette.textSubtle,\n    display: 'flex',\n    alignItems: 'center',\n    margin: 0,\n    minWidth: 200,\n  },\n  menuItem: {\n    '&:hover': {\n      background: 'transparent',\n    },\n  },\n  decreaseButton: {\n    marginRight: theme.spacing(1),\n  },\n  increaseButton: {\n    marginLeft: theme.spacing(1),\n  },\n}));\n\nexport const TextSizeAddon = () => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const [body] = useShadowRootElements(['body']);\n\n  const [value, setValue] = useState<number>(() => {\n    const initialValue = localStorage?.getItem(settings.key);\n    return initialValue ? parseInt(initialValue, 10) : settings.defaultValue;\n  });\n\n  const values = useMemo(() => marks.map(mark => mark.value), []);\n  const index = useMemo(() => values.indexOf(value), [values, value]);\n  const min = useMemo(() => values[0], [values]);\n  const max = useMemo(() => values[values.length - 1], [values]);\n\n  const getValueText = useCallback(() => `${value}%`, [value]);\n\n  const handleChangeCommitted = useCallback(\n    (_event: ChangeEvent<{}>, newValue: number | number[]) => {\n      if (!Array.isArray(newValue)) {\n        setValue(newValue);\n        localStorage?.setItem(settings.key, String(newValue));\n      }\n    },\n    [setValue],\n  );\n\n  const handleDecreaseClick = useCallback(\n    (event: MouseEvent) => {\n      handleChangeCommitted(event, values[index - 1]);\n    },\n    [index, values, handleChangeCommitted],\n  );\n\n  const handleIncreaseClick = useCallback(\n    (event: MouseEvent) => {\n      handleChangeCommitted(event, values[index + 1]);\n    },\n    [index, values, handleChangeCommitted],\n  );\n\n  useEffect(() => {\n    if (!body) return;\n    const htmlFontSize =\n      (\n        theme.typography as Theme['typography'] & {\n          htmlFontSize?: number;\n        }\n      )?.htmlFontSize ?? 16;\n    body.style.setProperty(\n      '--md-typeset-font-size',\n      `${htmlFontSize * (value / 100)}px`,\n    );\n  }, [body, value, theme]);\n\n  return (\n    <MenuItem className={classes.menuItem} button disableRipple>\n      <ListItemText\n        primary={\n          <Typography variant=\"subtitle2\" color=\"textPrimary\">\n            Text size\n          </Typography>\n        }\n        secondary={\n          <Box className={classes.container}>\n            <IconButton\n              className={classes.decreaseButton}\n              size=\"small\"\n              edge=\"start\"\n              disabled={value === min}\n              onClick={handleDecreaseClick}\n              aria-label=\"Decrease text size\"\n            >\n              <RemoveIcon />\n            </IconButton>\n            <StyledSlider\n              value={value}\n              aria-labelledby=\"text-size-slider\"\n              getAriaValueText={getValueText}\n              valueLabelDisplay=\"on\"\n              valueLabelFormat={getValueText}\n              marks={marks}\n              step={null}\n              min={min}\n              max={max}\n              onChangeCommitted={handleChangeCommitted}\n            />\n            <IconButton\n              className={classes.increaseButton}\n              size=\"small\"\n              edge=\"end\"\n              disabled={value === max}\n              onClick={handleIncreaseClick}\n              aria-label=\"Increase text size\"\n            >\n              <AddIcon />\n            </IconButton>\n          </Box>\n        }\n        disableTypography\n      />\n    </MenuItem>\n  );\n};\n"],"names":[],"mappings":"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"}