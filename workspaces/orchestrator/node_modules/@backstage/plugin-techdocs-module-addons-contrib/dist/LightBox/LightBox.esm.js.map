{"version":3,"file":"LightBox.esm.js","sources":["../../src/LightBox/LightBox.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\nimport { useShadowRootElements } from '@backstage/plugin-techdocs-react';\n// @ts-ignore\nimport PhotoSwipeLightbox, { DataSource, ZoomLevel } from 'photoswipe/lightbox';\nimport PhotoSwipe from 'photoswipe';\nimport 'photoswipe/style.css';\nimport './lightbox.css';\n\nexport const LightBoxAddon = () => {\n  const images = useShadowRootElements<HTMLImageElement>(['img']);\n\n  useEffect(() => {\n    let dataSourceImages: DataSource | null = null;\n\n    let lightbox: PhotoSwipeLightbox | null = new PhotoSwipeLightbox({\n      pswpModule: PhotoSwipe,\n      initialZoomLevel: 1,\n      secondaryZoomLevel: (zoomLevelObject: ZoomLevel) => {\n        // photoswipe/lightbox won't zoom the image further then the given width and height.\n        // therefore we need to calculate the zoom factor needed to fit the complete image in the viewport manually.\n        const imageWidth = zoomLevelObject.elementSize.x;\n        const imageHeight = zoomLevelObject.elementSize.y;\n        const viewportWidth = zoomLevelObject.panAreaSize.x;\n        const viewportHeight = zoomLevelObject.panAreaSize.y;\n\n        const widthScale = viewportWidth / imageWidth;\n        const heightScale = viewportHeight / imageHeight;\n\n        const scaleFactor = Math.min(widthScale, heightScale);\n        return scaleFactor;\n      },\n      wheelToZoom: true,\n      arrowPrevSVG:\n        '<svg class=\"MuiSvgIcon-root MuiSvgIcon-fontSizeLarge  css-c1sh5i\" focusable=\"false\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" data-testid=\"ArrowBackIosIcon\" aria-label=\"fontSize large\"><path d=\"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z\"></path></svg>',\n      arrowNextSVG:\n        '<svg class=\"MuiSvgIcon-root MuiSvgIcon-fontSizeLarge  css-c1sh5i\" focusable=\"false\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" data-testid=\"ArrowForwardIosIcon\" aria-label=\"fontSize large\"><path d=\"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z\"></path></svg>',\n      closeSVG:\n        '<svg class=\"MuiSvgIcon-root MuiSvgIcon-fontSizeLarge  css-c1sh5i\" focusable=\"false\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" data-testid=\"CloseIcon\" aria-label=\"fontSize large\"><path d=\"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"></path></svg>',\n      zoomSVG: `<svg class=\"MuiSvgIcon-root MuiSvgIcon-fontSizeLarge  css-c1sh5i\" focusable=\"false\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" data-testid=\"ZoomIcon\" aria-label=\"fontSize large\">\n          <path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path><path d=\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\" id=\"photoswipe-zoom-icon-zoomin-path\"></path><path d=\"M12 10H 7 V 9 H 12 Z\" id=\"photoswipe-zoom-icon-zoomout-path\">\n        </svg>`,\n    });\n\n    images.forEach((image, index) => {\n      image.onclick = () => {\n        if (dataSourceImages === null) {\n          dataSourceImages = images.map(dataSourceImage => {\n            return {\n              element: dataSourceImage,\n              src: dataSourceImage.src,\n              msrc: dataSourceImage.src,\n              alt: dataSourceImage.alt,\n              width: dataSourceImage.clientWidth,\n              height: dataSourceImage.clientHeight,\n            };\n          });\n        }\n        lightbox?.loadAndOpen(index, dataSourceImages);\n        return false;\n      };\n    });\n    lightbox.init();\n\n    return () => {\n      lightbox?.destroy();\n      lightbox = null;\n    };\n  }, [images]);\n\n  return null;\n};\n"],"names":[],"mappings":";;;;;;AAwBO,MAAM,gBAAgB,MAAM;AACjC,EAAA,MAAM,MAAA,GAAS,qBAAA,CAAwC,CAAC,KAAK,CAAC,CAAA;AAE9D,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,gBAAA,GAAsC,IAAA;AAE1C,IAAA,IAAI,QAAA,GAAsC,IAAI,kBAAA,CAAmB;AAAA,MAC/D,UAAA,EAAY,UAAA;AAAA,MACZ,gBAAA,EAAkB,CAAA;AAAA,MAClB,kBAAA,EAAoB,CAAC,eAAA,KAA+B;AAGlD,QAAA,MAAM,UAAA,GAAa,gBAAgB,WAAA,CAAY,CAAA;AAC/C,QAAA,MAAM,WAAA,GAAc,gBAAgB,WAAA,CAAY,CAAA;AAChD,QAAA,MAAM,aAAA,GAAgB,gBAAgB,WAAA,CAAY,CAAA;AAClD,QAAA,MAAM,cAAA,GAAiB,gBAAgB,WAAA,CAAY,CAAA;AAEnD,QAAA,MAAM,aAAa,aAAA,GAAgB,UAAA;AACnC,QAAA,MAAM,cAAc,cAAA,GAAiB,WAAA;AAErC,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,GAAA,CAAI,UAAA,EAAY,WAAW,CAAA;AACpD,QAAA,OAAO,WAAA;AAAA,MACT,CAAA;AAAA,MACA,WAAA,EAAa,IAAA;AAAA,MACb,YAAA,EACE,mQAAA;AAAA,MACF,YAAA,EACE,iQAAA;AAAA,MACF,QAAA,EACE,8SAAA;AAAA,MACF,OAAA,EAAS,CAAA;AAAA;AAAA,cAAA;AAAA,KAGV,CAAA;AAED,IAAA,MAAA,CAAO,OAAA,CAAQ,CAAC,KAAA,EAAO,KAAA,KAAU;AAC/B,MAAA,KAAA,CAAM,UAAU,MAAM;AACpB,QAAA,IAAI,qBAAqB,IAAA,EAAM;AAC7B,UAAA,gBAAA,GAAmB,MAAA,CAAO,IAAI,CAAA,eAAA,KAAmB;AAC/C,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,eAAA;AAAA,cACT,KAAK,eAAA,CAAgB,GAAA;AAAA,cACrB,MAAM,eAAA,CAAgB,GAAA;AAAA,cACtB,KAAK,eAAA,CAAgB,GAAA;AAAA,cACrB,OAAO,eAAA,CAAgB,WAAA;AAAA,cACvB,QAAQ,eAAA,CAAgB;AAAA,aAC1B;AAAA,UACF,CAAC,CAAA;AAAA,QACH;AACA,QAAA,QAAA,EAAU,WAAA,CAAY,OAAO,gBAAgB,CAAA;AAC7C,QAAA,OAAO,KAAA;AAAA,MACT,CAAA;AAAA,IACF,CAAC,CAAA;AACD,IAAA,QAAA,CAAS,IAAA,EAAK;AAEd,IAAA,OAAO,MAAM;AACX,MAAA,QAAA,EAAU,OAAA,EAAQ;AAClB,MAAA,QAAA,GAAW,IAAA;AAAA,IACb,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,MAAM,CAAC,CAAA;AAEX,EAAA,OAAO,IAAA;AACT;;;;"}