import { jsx, jsxs } from 'react/jsx-runtime';
import { useEntity } from '@backstage/plugin-catalog-react';
import Alert from '@material-ui/lab/Alert';
import { apiDocsConfigRef } from '../../config.esm.js';
import { PlainApiDefinitionWidget } from '../PlainApiDefinitionWidget/PlainApiDefinitionWidget.esm.js';
import { TabbedCard, CardTab } from '@backstage/core-components';
import { useApi } from '@backstage/core-plugin-api';

const ApiDefinitionCard = () => {
  const { entity } = useEntity();
  const config = useApi(apiDocsConfigRef);
  const { getApiDefinitionWidget } = config;
  if (!entity) {
    return /* @__PURE__ */ jsx(Alert, { severity: "error", children: "Could not fetch the API" });
  }
  const definitionWidget = getApiDefinitionWidget(entity);
  const entityTitle = entity.metadata.title ?? entity.metadata.name;
  if (definitionWidget) {
    return /* @__PURE__ */ jsxs(TabbedCard, { title: entityTitle, children: [
      /* @__PURE__ */ jsx(CardTab, { label: definitionWidget.title, children: definitionWidget.component(entity.spec.definition) }, "widget"),
      /* @__PURE__ */ jsx(CardTab, { label: "Raw", children: /* @__PURE__ */ jsx(
        PlainApiDefinitionWidget,
        {
          definition: entity.spec.definition,
          language: definitionWidget.rawLanguage || entity.spec.type
        }
      ) }, "raw")
    ] });
  }
  return /* @__PURE__ */ jsx(
    TabbedCard,
    {
      title: entityTitle,
      children: [
        // Has to be an array, otherwise typescript doesn't like that this has only a single child
        /* @__PURE__ */ jsx(CardTab, { label: entity.spec.type, children: /* @__PURE__ */ jsx(
          PlainApiDefinitionWidget,
          {
            definition: entity.spec.definition,
            language: entity.spec.type
          }
        ) }, "raw")
      ]
    }
  );
};

export { ApiDefinitionCard };
//# sourceMappingURL=ApiDefinitionCard.esm.js.map
