{"version":3,"file":"ApiDefinitionDialog.esm.js","sources":["../../../src/components/ApiDefinitionDialog/ApiDefinitionDialog.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ApiEntity } from '@backstage/catalog-model';\nimport { useApi } from '@backstage/core-plugin-api';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { ReactNode, useState, useEffect } from 'react';\nimport { apiDocsConfigRef } from '../../config';\nimport { PlainApiDefinitionWidget } from '../PlainApiDefinitionWidget';\nimport { useTranslationRef } from '@backstage/frontend-plugin-api';\nimport { apiDocsTranslationRef } from '../../translation';\n\nconst useStyles = makeStyles(theme => ({\n  fullHeightDialog: {\n    height: 'calc(100% - 64px)',\n  },\n  root: {\n    display: 'flex',\n    flexGrow: 1,\n    width: '100%',\n    height: '100%',\n  },\n  tabs: {\n    borderRight: `1px solid ${theme.palette.divider}`,\n    flexShrink: 0,\n  },\n  tabContents: {\n    flexGrow: 1,\n    overflowX: 'auto',\n  },\n  title: {\n    color: theme.palette.text.primary,\n    wordBreak: 'break-word',\n    fontSize: theme.typography.h3.fontSize,\n    marginBottom: 0,\n  },\n  type: {\n    textTransform: 'uppercase',\n    fontSize: 11,\n    opacity: 0.8,\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.primary,\n  },\n}));\n\nfunction TabPanel(props: {\n  children?: ReactNode;\n  index: number;\n  value: number;\n}) {\n  const { children, value, index, ...other } = props;\n  const classes = useStyles();\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`vertical-tabpanel-${index}`}\n      aria-labelledby={`vertical-tab-${index}`}\n      className={classes.tabContents}\n      {...other}\n    >\n      {value === index && (\n        <Box pl={3} pr={3}>\n          {children}\n        </Box>\n      )}\n    </div>\n  );\n}\n\nfunction a11yProps(index: number) {\n  return {\n    id: `vertical-tab-${index}`,\n    'aria-controls': `vertical-tabpanel-${index}`,\n  };\n}\n\n/**\n * A dialog that lets users inspect the API definition.\n *\n * @public\n */\nexport function ApiDefinitionDialog(props: {\n  open: boolean;\n  entity: ApiEntity;\n  onClose: () => void;\n}) {\n  const { open, entity, onClose } = props;\n  const [activeTab, setActiveTab] = useState(0);\n  const classes = useStyles();\n  const { t } = useTranslationRef(apiDocsTranslationRef);\n\n  useEffect(() => {\n    setActiveTab(0);\n  }, [open]);\n\n  const config = useApi(apiDocsConfigRef);\n  const definitionWidget = config.getApiDefinitionWidget(entity);\n\n  let tabIndex = 0;\n  let tabPanelIndex = 0;\n\n  return (\n    <Dialog\n      fullWidth\n      maxWidth=\"xl\"\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"api-definition-dialog-title\"\n      PaperProps={{ className: classes.fullHeightDialog }}\n    >\n      <DialogTitle id=\"api-definition-dialog-title\" disableTypography>\n        <Typography className={classes.type}>\n          API - {definitionWidget?.title ?? 'Raw'}\n        </Typography>\n        <Typography className={classes.title} variant=\"h1\">\n          {entity.metadata.title ?? entity.metadata.name}\n        </Typography>\n      </DialogTitle>\n      <DialogContent dividers className={classes.root}>\n        <Tabs\n          orientation=\"vertical\"\n          variant=\"scrollable\"\n          value={activeTab}\n          onChange={(_, newValue) => setActiveTab(newValue)}\n          aria-label={t('apiDefinitionDialog.tabsAriaLabel')}\n          className={classes.tabs}\n        >\n          {definitionWidget ? (\n            <Tab label={definitionWidget.title} {...a11yProps(tabIndex++)} />\n          ) : null}\n          <Tab label=\"Raw\" {...a11yProps(tabIndex++)} />\n        </Tabs>\n\n        {definitionWidget ? (\n          <TabPanel value={activeTab} index={tabPanelIndex++}>\n            {definitionWidget.component(entity.spec.definition)}\n          </TabPanel>\n        ) : null}\n        <TabPanel value={activeTab} index={tabPanelIndex++}>\n          <PlainApiDefinitionWidget\n            definition={entity.spec.definition}\n            language={definitionWidget?.rawLanguage ?? entity.spec.type}\n          />\n        </TabPanel>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          {t('apiDefinitionDialog.closeButtonTitle')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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"}