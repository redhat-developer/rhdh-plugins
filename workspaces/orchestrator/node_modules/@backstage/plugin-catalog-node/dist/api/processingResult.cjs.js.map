{"version":3,"file":"processingResult.cjs.js","sources":["../../src/api/processingResult.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InputError, NotFoundError } from '@backstage/errors';\nimport { Entity } from '@backstage/catalog-model';\nimport { CatalogProcessorResult } from './processor';\nimport { EntityRelationSpec } from './common';\nimport { LocationSpec } from '@backstage/plugin-catalog-common';\n\n/**\n * Factory functions for the standard processing result types.\n *\n * @public\n */\nexport const processingResult = Object.freeze({\n  /**\n   * Associates a NotFoundError with the processing state of the current entity.\n   */\n  notFoundError(\n    atLocation: LocationSpec,\n    message: string,\n  ): CatalogProcessorResult {\n    return {\n      type: 'error',\n      location: atLocation,\n      error: new NotFoundError(message),\n    };\n  },\n\n  /**\n   * Associates an InputError with the processing state of the current entity.\n   */\n  inputError(\n    atLocation: LocationSpec,\n    message: string,\n  ): CatalogProcessorResult {\n    return {\n      type: 'error',\n      location: atLocation,\n      error: new InputError(message),\n    };\n  },\n\n  /**\n   * Associates a general Error with the processing state of the current entity.\n   */\n  generalError(\n    atLocation: LocationSpec,\n    message: string,\n  ): CatalogProcessorResult {\n    return { type: 'error', location: atLocation, error: new Error(message) };\n  },\n\n  /**\n   * Emits a location. In effect, this is analogous to emitting a Location kind\n   * child entity. This is commonly used in discovery processors. Do not use\n   * this while processing Location entities.\n   */\n  location(newLocation: LocationSpec): CatalogProcessorResult {\n    return { type: 'location', location: newLocation };\n  },\n\n  /**\n   * Emits a child of the current entity, associated with a certain location.\n   */\n  entity(\n    atLocation: LocationSpec,\n    newEntity: Entity,\n    options?: {\n      /**\n       * Sets the location key of the emitted entity, overriding the default one derived from the location.\n       *\n       * To set a `null` location key the value `null` must be used.\n       */\n      locationKey?: string | null;\n    },\n  ): CatalogProcessorResult {\n    return {\n      type: 'entity',\n      location: atLocation,\n      entity: newEntity,\n      locationKey: options?.locationKey,\n    };\n  },\n\n  /**\n   * Emits a relation owned by the current entity. The relation does not have to\n   * start or end at the current entity. The relation only lives for as long as\n   * the current entity lives.\n   */\n  relation(spec: EntityRelationSpec): CatalogProcessorResult {\n    return { type: 'relation', relation: spec };\n  },\n\n  /**\n   * Associates the given refresh key with the current entity. The effect of\n   * this is that the entity will be marked for refresh when such requests are\n   * made.\n   */\n  refresh(key: string): CatalogProcessorResult {\n    return { type: 'refresh', key };\n  },\n} as const);\n"],"names":["NotFoundError","InputError"],"mappings":";;;;AA2BO,MAAM,gBAAA,GAAmB,OAAO,MAAA,CAAO;AAAA;AAAA;AAAA;AAAA,EAI5C,aAAA,CACE,YACA,OAAA,EACwB;AACxB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,OAAA;AAAA,MACN,QAAA,EAAU,UAAA;AAAA,MACV,KAAA,EAAO,IAAIA,oBAAA,CAAc,OAAO;AAAA,KAClC;AAAA,EACF,CAAA;AAAA;AAAA;AAAA;AAAA,EAKA,UAAA,CACE,YACA,OAAA,EACwB;AACxB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,OAAA;AAAA,MACN,QAAA,EAAU,UAAA;AAAA,MACV,KAAA,EAAO,IAAIC,iBAAA,CAAW,OAAO;AAAA,KAC/B;AAAA,EACF,CAAA;AAAA;AAAA;AAAA;AAAA,EAKA,YAAA,CACE,YACA,OAAA,EACwB;AACxB,IAAA,OAAO,EAAE,MAAM,OAAA,EAAS,QAAA,EAAU,YAAY,KAAA,EAAO,IAAI,KAAA,CAAM,OAAO,CAAA,EAAE;AAAA,EAC1E,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,SAAS,WAAA,EAAmD;AAC1D,IAAA,OAAO,EAAE,IAAA,EAAM,UAAA,EAAY,QAAA,EAAU,WAAA,EAAY;AAAA,EACnD,CAAA;AAAA;AAAA;AAAA;AAAA,EAKA,MAAA,CACE,UAAA,EACA,SAAA,EACA,OAAA,EAQwB;AACxB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,QAAA;AAAA,MACN,QAAA,EAAU,UAAA;AAAA,MACV,MAAA,EAAQ,SAAA;AAAA,MACR,aAAa,OAAA,EAAS;AAAA,KACxB;AAAA,EACF,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,SAAS,IAAA,EAAkD;AACzD,IAAA,OAAO,EAAE,IAAA,EAAM,UAAA,EAAY,QAAA,EAAU,IAAA,EAAK;AAAA,EAC5C,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,QAAQ,GAAA,EAAqC;AAC3C,IAAA,OAAO,EAAE,IAAA,EAAM,SAAA,EAAW,GAAA,EAAI;AAAA,EAChC;AACF,CAAU;;;;"}