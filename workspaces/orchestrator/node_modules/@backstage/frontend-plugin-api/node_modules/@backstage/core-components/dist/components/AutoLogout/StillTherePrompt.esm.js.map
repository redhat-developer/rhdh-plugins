{"version":3,"file":"StillTherePrompt.esm.js","sources":["../../../src/components/AutoLogout/StillTherePrompt.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { useEffect } from 'react';\nimport { IIdleTimer } from 'react-idle-timer';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport interface StillTherePromptProps {\n  idleTimer: IIdleTimer;\n  promptTimeoutMillis: number;\n  remainingTime: number;\n  setRemainingTime: (amount: number) => void;\n  open: boolean;\n  setOpen: (value: boolean) => void;\n}\n\nexport const StillTherePrompt = (props: StillTherePromptProps) => {\n  const {\n    idleTimer,\n    setOpen,\n    open,\n    promptTimeoutMillis,\n    remainingTime,\n    setRemainingTime,\n  } = props;\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setRemainingTime(Math.ceil(idleTimer.getRemainingTime()));\n    }, 500);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [idleTimer, setRemainingTime]);\n\n  const handleStillHere = () => {\n    setOpen(false);\n    idleTimer.activate();\n  };\n\n  const timeTillPrompt = Math.max(\n    remainingTime - promptTimeoutMillis / 1000,\n    0,\n  );\n  const seconds = timeTillPrompt > 1 ? 'seconds' : 'second';\n\n  return (\n    <Dialog open={open} data-testid=\"inactivity-prompt-dialog\">\n      <DialogTitle>{t('autoLogout.stillTherePrompt.title')}</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          You are about to be disconnected in{' '}\n          <b>\n            {Math.ceil(remainingTime / 1000)} {seconds}\n          </b>\n          . Are you still there?\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          onClick={handleStillHere}\n          color=\"secondary\"\n          variant=\"contained\"\n          size=\"small\"\n        >\n          {t('autoLogout.stillTherePrompt.buttonText')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;AAoCO,MAAM,gBAAA,GAAmB,CAAC,KAAA,KAAiC;AAChE,EAAA,MAAM;AAAA,IACJ,SAAA;AAAA,IACA,OAAA;AAAA,IACA,IAAA;AAAA,IACA,mBAAA;AAAA,IACA,aAAA;AAAA,IACA;AAAA,GACF,GAAI,KAAA;AACJ,EAAA,MAAM,EAAE,CAAA,EAAE,GAAI,iBAAA,CAAkB,4BAA4B,CAAA;AAE5D,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,MAAM,QAAA,GAAW,YAAY,MAAM;AACjC,MAAA,gBAAA,CAAiB,IAAA,CAAK,IAAA,CAAK,SAAA,CAAU,gBAAA,EAAkB,CAAC,CAAA;AAAA,IAC1D,GAAG,GAAG,CAAA;AAEN,IAAA,OAAO,MAAM;AACX,MAAA,aAAA,CAAc,QAAQ,CAAA;AAAA,IACxB,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,SAAA,EAAW,gBAAgB,CAAC,CAAA;AAEhC,EAAA,MAAM,kBAAkB,MAAM;AAC5B,IAAA,OAAA,CAAQ,KAAK,CAAA;AACb,IAAA,SAAA,CAAU,QAAA,EAAS;AAAA,EACrB,CAAA;AAEA,EAAA,MAAM,iBAAiB,IAAA,CAAK,GAAA;AAAA,IAC1B,gBAAgB,mBAAA,GAAsB,GAAA;AAAA,IACtC;AAAA,GACF;AACA,EAAA,MAAM,OAAA,GAAU,cAAA,GAAiB,CAAA,GAAI,SAAA,GAAY,QAAA;AAEjD,EAAA,uBACE,IAAA,CAAC,MAAA,EAAA,EAAO,IAAA,EAAY,aAAA,EAAY,0BAAA,EAC9B,QAAA,EAAA;AAAA,oBAAA,GAAA,CAAC,WAAA,EAAA,EAAa,QAAA,EAAA,CAAA,CAAE,mCAAmC,CAAA,EAAE,CAAA;AAAA,oBACrD,GAAA,CAAC,aAAA,EAAA,EACC,QAAA,kBAAA,IAAA,CAAC,iBAAA,EAAA,EAAkB,QAAA,EAAA;AAAA,MAAA,qCAAA;AAAA,MACmB,GAAA;AAAA,2BACnC,GAAA,EAAA,EACE,QAAA,EAAA;AAAA,QAAA,IAAA,CAAK,IAAA,CAAK,gBAAgB,GAAI,CAAA;AAAA,QAAE,GAAA;AAAA,QAAE;AAAA,OAAA,EACrC,CAAA;AAAA,MAAI;AAAA,KAAA,EAEN,CAAA,EACF,CAAA;AAAA,wBACC,aAAA,EAAA,EACC,QAAA,kBAAA,GAAA;AAAA,MAAC,MAAA;AAAA,MAAA;AAAA,QACC,OAAA,EAAS,eAAA;AAAA,QACT,KAAA,EAAM,WAAA;AAAA,QACN,OAAA,EAAQ,WAAA;AAAA,QACR,IAAA,EAAK,OAAA;AAAA,QAEJ,YAAE,wCAAwC;AAAA;AAAA,KAC7C,EACF;AAAA,GAAA,EACF,CAAA;AAEJ;;;;"}