{"version":3,"file":"MockStarredEntitiesApi.esm.js","sources":["../../../src/apis/StarredEntitiesApi/MockStarredEntitiesApi.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from '@backstage/types';\nimport ObservableImpl from 'zen-observable';\nimport { StarredEntitiesApi } from './StarredEntitiesApi';\n\n/**\n * An in-memory mock implementation of the StarredEntitiesApi.\n *\n * @public\n */\nexport class MockStarredEntitiesApi implements StarredEntitiesApi {\n  private readonly starredEntities = new Set<string>();\n  private readonly subscribers = new Set<\n    ZenObservable.SubscriptionObserver<Set<string>>\n  >();\n\n  private readonly observable = new ObservableImpl<Set<string>>(subscriber => {\n    subscriber.next(new Set(this.starredEntities));\n\n    this.subscribers.add(subscriber);\n    return () => {\n      this.subscribers.delete(subscriber);\n    };\n  });\n\n  async toggleStarred(entityRef: string): Promise<void> {\n    if (!this.starredEntities.delete(entityRef)) {\n      this.starredEntities.add(entityRef);\n    }\n\n    for (const subscription of this.subscribers) {\n      subscription.next(new Set(this.starredEntities));\n    }\n  }\n\n  starredEntitie$(): Observable<Set<string>> {\n    return this.observable;\n  }\n}\n"],"names":[],"mappings":";;AAyBO,MAAM,sBAAA,CAAqD;AAAA,EAC/C,eAAA,uBAAsB,GAAA,EAAY;AAAA,EAClC,WAAA,uBAAkB,GAAA,EAEjC;AAAA,EAEe,UAAA,GAAa,IAAI,cAAA,CAA4B,CAAA,UAAA,KAAc;AAC1E,IAAA,UAAA,CAAW,IAAA,CAAK,IAAI,GAAA,CAAI,IAAA,CAAK,eAAe,CAAC,CAAA;AAE7C,IAAA,IAAA,CAAK,WAAA,CAAY,IAAI,UAAU,CAAA;AAC/B,IAAA,OAAO,MAAM;AACX,MAAA,IAAA,CAAK,WAAA,CAAY,OAAO,UAAU,CAAA;AAAA,IACpC,CAAA;AAAA,EACF,CAAC,CAAA;AAAA,EAED,MAAM,cAAc,SAAA,EAAkC;AACpD,IAAA,IAAI,CAAC,IAAA,CAAK,eAAA,CAAgB,MAAA,CAAO,SAAS,CAAA,EAAG;AAC3C,MAAA,IAAA,CAAK,eAAA,CAAgB,IAAI,SAAS,CAAA;AAAA,IACpC;AAEA,IAAA,KAAA,MAAW,YAAA,IAAgB,KAAK,WAAA,EAAa;AAC3C,MAAA,YAAA,CAAa,IAAA,CAAK,IAAI,GAAA,CAAI,IAAA,CAAK,eAAe,CAAC,CAAA;AAAA,IACjD;AAAA,EACF;AAAA,EAEA,eAAA,GAA2C;AACzC,IAAA,OAAO,IAAA,CAAK,UAAA;AAAA,EACd;AACF;;;;"}