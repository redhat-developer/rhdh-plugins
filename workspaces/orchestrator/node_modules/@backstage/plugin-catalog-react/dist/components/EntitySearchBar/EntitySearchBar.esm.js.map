{"version":3,"file":"EntitySearchBar.esm.js","sources":["../../../src/components/EntitySearchBar/EntitySearchBar.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Clear from '@material-ui/icons/Clear';\nimport Search from '@material-ui/icons/Search';\nimport { useEffect, useMemo, useState } from 'react';\nimport useDebounce from 'react-use/lib/useDebounce';\nimport { useEntityList } from '../../hooks/useEntityListProvider';\nimport { EntityTextFilter } from '../../filters';\nimport { catalogReactTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\n/** @public */\nexport type CatalogReactEntitySearchBarClassKey = 'searchToolbar' | 'input';\n\nconst useStyles = makeStyles(\n  _theme => ({\n    searchToolbar: {\n      paddingLeft: 0,\n      paddingRight: 0,\n    },\n    input: {},\n  }),\n  { name: 'CatalogReactEntitySearchBar' },\n);\n\n/**\n * Renders search bar for filtering the entity list.\n * @public\n */\nexport const EntitySearchBar = () => {\n  const classes = useStyles();\n  const { t } = useTranslationRef(catalogReactTranslationRef);\n\n  const {\n    updateFilters,\n    queryParameters: { text: textParameter },\n  } = useEntityList();\n\n  const queryParamTextFilter = useMemo(\n    () => [textParameter].flat()[0],\n    [textParameter],\n  );\n\n  const [search, setSearch] = useState(queryParamTextFilter ?? '');\n\n  useDebounce(\n    () => {\n      updateFilters({\n        text: search.length ? new EntityTextFilter(search) : undefined,\n      });\n    },\n    250,\n    [search, updateFilters],\n  );\n\n  useEffect(() => {\n    if (queryParamTextFilter) {\n      setSearch(queryParamTextFilter);\n    }\n  }, [queryParamTextFilter]);\n\n  return (\n    <Toolbar className={classes.searchToolbar}>\n      <FormControl>\n        <Input\n          aria-label=\"search\"\n          id=\"input-with-icon-adornment\"\n          className={classes.input}\n          placeholder={t('entitySearchBar.placeholder')}\n          autoComplete=\"off\"\n          onChange={event => setSearch(event.target.value)}\n          value={search}\n          startAdornment={\n            <InputAdornment position=\"start\">\n              <Search />\n            </InputAdornment>\n          }\n          endAdornment={\n            <InputAdornment position=\"end\">\n              <IconButton\n                aria-label=\"clear search\"\n                onClick={() => setSearch('')}\n                edge=\"end\"\n                disabled={search.length === 0}\n              >\n                <Clear />\n              </IconButton>\n            </InputAdornment>\n          }\n        />\n      </FormControl>\n    </Toolbar>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAkCA,MAAM,SAAA,GAAY,UAAA;AAAA,EAChB,CAAA,MAAA,MAAW;AAAA,IACT,aAAA,EAAe;AAAA,MACb,WAAA,EAAa,CAAA;AAAA,MACb,YAAA,EAAc;AAAA,KAChB;AAAA,IACA,OAAO;AAAC,GACV,CAAA;AAAA,EACA,EAAE,MAAM,6BAAA;AACV,CAAA;AAMO,MAAM,kBAAkB,MAAM;AACnC,EAAA,MAAM,UAAU,SAAA,EAAU;AAC1B,EAAA,MAAM,EAAE,CAAA,EAAE,GAAI,iBAAA,CAAkB,0BAA0B,CAAA;AAE1D,EAAA,MAAM;AAAA,IACJ,aAAA;AAAA,IACA,eAAA,EAAiB,EAAE,IAAA,EAAM,aAAA;AAAc,MACrC,aAAA,EAAc;AAElB,EAAA,MAAM,oBAAA,GAAuB,OAAA;AAAA,IAC3B,MAAM,CAAC,aAAa,CAAA,CAAE,IAAA,GAAO,CAAC,CAAA;AAAA,IAC9B,CAAC,aAAa;AAAA,GAChB;AAEA,EAAA,MAAM,CAAC,MAAA,EAAQ,SAAS,CAAA,GAAI,QAAA,CAAS,wBAAwB,EAAE,CAAA;AAE/D,EAAA,WAAA;AAAA,IACE,MAAM;AACJ,MAAA,aAAA,CAAc;AAAA,QACZ,MAAM,MAAA,CAAO,MAAA,GAAS,IAAI,gBAAA,CAAiB,MAAM,CAAA,GAAI;AAAA,OACtD,CAAA;AAAA,IACH,CAAA;AAAA,IACA,GAAA;AAAA,IACA,CAAC,QAAQ,aAAa;AAAA,GACxB;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,oBAAA,EAAsB;AACxB,MAAA,SAAA,CAAU,oBAAoB,CAAA;AAAA,IAChC;AAAA,EACF,CAAA,EAAG,CAAC,oBAAoB,CAAC,CAAA;AAEzB,EAAA,2BACG,OAAA,EAAA,EAAQ,SAAA,EAAW,OAAA,CAAQ,aAAA,EAC1B,8BAAC,WAAA,EAAA,EACC,QAAA,kBAAA,GAAA;AAAA,IAAC,KAAA;AAAA,IAAA;AAAA,MACC,YAAA,EAAW,QAAA;AAAA,MACX,EAAA,EAAG,2BAAA;AAAA,MACH,WAAW,OAAA,CAAQ,KAAA;AAAA,MACnB,WAAA,EAAa,EAAE,6BAA6B,CAAA;AAAA,MAC5C,YAAA,EAAa,KAAA;AAAA,MACb,QAAA,EAAU,CAAA,KAAA,KAAS,SAAA,CAAU,KAAA,CAAM,OAAO,KAAK,CAAA;AAAA,MAC/C,KAAA,EAAO,MAAA;AAAA,MACP,gCACE,GAAA,CAAC,cAAA,EAAA,EAAe,UAAS,OAAA,EACvB,QAAA,kBAAA,GAAA,CAAC,UAAO,CAAA,EACV,CAAA;AAAA,MAEF,YAAA,kBACE,GAAA,CAAC,cAAA,EAAA,EAAe,QAAA,EAAS,KAAA,EACvB,QAAA,kBAAA,GAAA;AAAA,QAAC,UAAA;AAAA,QAAA;AAAA,UACC,YAAA,EAAW,cAAA;AAAA,UACX,OAAA,EAAS,MAAM,SAAA,CAAU,EAAE,CAAA;AAAA,UAC3B,IAAA,EAAK,KAAA;AAAA,UACL,QAAA,EAAU,OAAO,MAAA,KAAW,CAAA;AAAA,UAE5B,8BAAC,KAAA,EAAA,EAAM;AAAA;AAAA,OACT,EACF;AAAA;AAAA,KAGN,CAAA,EACF,CAAA;AAEJ;;;;"}