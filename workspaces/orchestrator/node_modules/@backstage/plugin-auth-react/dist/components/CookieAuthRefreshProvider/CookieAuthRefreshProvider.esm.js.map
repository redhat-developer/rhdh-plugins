{"version":3,"file":"CookieAuthRefreshProvider.esm.js","sources":["../../../src/components/CookieAuthRefreshProvider/CookieAuthRefreshProvider.tsx"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ReactNode } from 'react';\nimport { ErrorPanel } from '@backstage/core-components';\nimport { useApp } from '@backstage/core-plugin-api';\nimport Button from '@material-ui/core/Button';\nimport { useCookieAuthRefresh } from '../../hooks';\n\n/**\n * @public\n * Props for the {@link CookieAuthRefreshProvider} component.\n */\nexport type CookieAuthRefreshProviderProps = {\n  // The plugin ID used for discovering the API origin\n  pluginId: string;\n  // The children to render when the refresh is successful\n  children: ReactNode;\n};\n\n/**\n * @public\n * A provider that will refresh the cookie when it is about to expire.\n */\nexport function CookieAuthRefreshProvider(\n  props: CookieAuthRefreshProviderProps,\n): JSX.Element {\n  const { children, ...options } = props;\n  const app = useApp();\n  const { Progress } = app.getComponents();\n\n  const result = useCookieAuthRefresh(options);\n\n  if (result.status === 'loading') {\n    return <Progress />;\n  }\n\n  if (result.status === 'error') {\n    return (\n      <ErrorPanel error={result.error}>\n        <Button variant=\"outlined\" onClick={result.retry}>\n          Retry\n        </Button>\n      </ErrorPanel>\n    );\n  }\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;;AAqCO,SAAS,0BACd,KAAA,EACa;AACb,EAAA,MAAM,EAAE,QAAA,EAAU,GAAG,OAAA,EAAQ,GAAI,KAAA;AACjC,EAAA,MAAM,MAAM,MAAA,EAAO;AACnB,EAAA,MAAM,EAAE,QAAA,EAAS,GAAI,GAAA,CAAI,aAAA,EAAc;AAEvC,EAAA,MAAM,MAAA,GAAS,qBAAqB,OAAO,CAAA;AAE3C,EAAA,IAAI,MAAA,CAAO,WAAW,SAAA,EAAW;AAC/B,IAAA,2BAAQ,QAAA,EAAA,EAAS,CAAA;AAAA,EACnB;AAEA,EAAA,IAAI,MAAA,CAAO,WAAW,OAAA,EAAS;AAC7B,IAAA,uBACE,GAAA,CAAC,UAAA,EAAA,EAAW,KAAA,EAAO,MAAA,CAAO,KAAA,EACxB,QAAA,kBAAA,GAAA,CAAC,MAAA,EAAA,EAAO,OAAA,EAAQ,UAAA,EAAW,OAAA,EAAS,MAAA,CAAO,KAAA,EAAO,mBAElD,CAAA,EACF,CAAA;AAAA,EAEJ;AAEA,EAAA,uCAAU,QAAA,EAAS,CAAA;AACrB;;;;"}