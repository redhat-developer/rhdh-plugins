{"version":3,"file":"MockUserInfoService.cjs.js","sources":["../../src/services/MockUserInfoService.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageCredentials,\n  BackstageNonePrincipal,\n  BackstageServicePrincipal,\n  BackstageUserInfo,\n  BackstageUserPrincipal,\n  UserInfoService,\n} from '@backstage/backend-plugin-api';\nimport { InputError } from '@backstage/errors';\n\n/** @internal */\nexport class MockUserInfoService implements UserInfoService {\n  private readonly customInfo: Partial<BackstageUserInfo>;\n\n  constructor(customInfo?: Partial<BackstageUserInfo>) {\n    this.customInfo = customInfo ?? {};\n  }\n\n  async getUserInfo(\n    credentials: BackstageCredentials,\n  ): Promise<BackstageUserInfo> {\n    const principal = credentials.principal as\n      | BackstageUserPrincipal\n      | BackstageServicePrincipal\n      | BackstageNonePrincipal;\n\n    if (principal.type !== 'user') {\n      throw new InputError(\n        `User info not available for principal type '${principal.type}'`,\n      );\n    }\n\n    return {\n      userEntityRef: principal.userEntityRef,\n      ownershipEntityRefs: [principal.userEntityRef],\n      ...this.customInfo,\n    };\n  }\n}\n"],"names":["InputError"],"mappings":";;;;AA2BO,MAAM,mBAAA,CAA+C;AAAA,EACzC,UAAA;AAAA,EAEjB,YAAY,UAAA,EAAyC;AACnD,IAAA,IAAA,CAAK,UAAA,GAAa,cAAc,EAAC;AAAA,EACnC;AAAA,EAEA,MAAM,YACJ,WAAA,EAC4B;AAC5B,IAAA,MAAM,YAAY,WAAA,CAAY,SAAA;AAK9B,IAAA,IAAI,SAAA,CAAU,SAAS,MAAA,EAAQ;AAC7B,MAAA,MAAM,IAAIA,iBAAA;AAAA,QACR,CAAA,4CAAA,EAA+C,UAAU,IAAI,CAAA,CAAA;AAAA,OAC/D;AAAA,IACF;AAEA,IAAA,OAAO;AAAA,MACL,eAAe,SAAA,CAAU,aAAA;AAAA,MACzB,mBAAA,EAAqB,CAAC,SAAA,CAAU,aAAa,CAAA;AAAA,MAC7C,GAAG,IAAA,CAAK;AAAA,KACV;AAAA,EACF;AACF;;;;"}