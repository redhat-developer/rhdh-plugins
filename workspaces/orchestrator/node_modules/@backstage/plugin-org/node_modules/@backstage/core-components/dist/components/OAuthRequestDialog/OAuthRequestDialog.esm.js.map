{"version":3,"file":"OAuthRequestDialog.esm.js","sources":["../../../src/components/OAuthRequestDialog/OAuthRequestDialog.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport List from '@material-ui/core/List';\nimport Button from '@material-ui/core/Button';\nimport { useMemo, useState } from 'react';\nimport useObservable from 'react-use/esm/useObservable';\nimport LoginRequestListItem from './LoginRequestListItem';\nimport {\n  useApi,\n  configApiRef,\n  oauthRequestApiRef,\n} from '@backstage/core-plugin-api';\nimport Typography from '@material-ui/core/Typography';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport type OAuthRequestDialogClassKey =\n  | 'dialog'\n  | 'title'\n  | 'contentList'\n  | 'actionButtons';\n\nconst useStyles = makeStyles(\n  theme => ({\n    dialog: {\n      paddingTop: theme.spacing(1),\n    },\n    title: {\n      minWidth: 0,\n    },\n    titleHeading: {\n      fontSize: theme.typography.h6.fontSize,\n    },\n    contentList: {\n      padding: 0,\n    },\n    actionButtons: {\n      padding: theme.spacing(2, 0),\n    },\n  }),\n  { name: 'OAuthRequestDialog' },\n);\n\nexport function OAuthRequestDialog(_props: {}) {\n  const classes = useStyles();\n  const [busy, setBusy] = useState(false);\n  const oauthRequestApi = useApi(oauthRequestApiRef);\n  const configApi = useApi(configApiRef);\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  const authRedirect =\n    configApi.getOptionalBoolean('enableExperimentalRedirectFlow') ?? false;\n\n  const requests = useObservable(\n    useMemo(() => oauthRequestApi.authRequest$(), [oauthRequestApi]),\n    [],\n  );\n\n  const handleRejectAll = () => {\n    requests.forEach(request => request.reject());\n  };\n\n  return (\n    <Dialog\n      open={Boolean(requests.length)}\n      fullWidth\n      maxWidth=\"xs\"\n      classes={{ paper: classes.dialog }}\n      aria-labelledby=\"oauth-req-dialog-title\"\n    >\n      <main>\n        <DialogTitle\n          classes={{ root: classes.title }}\n          id=\"oauth-req-dialog-title\"\n        >\n          <Typography\n            className={classes.titleHeading}\n            variant=\"h1\"\n            variantMapping={{ h1: 'span' }}\n          >\n            {t('oauthRequestDialog.title')}\n          </Typography>\n          {authRedirect ? (\n            <Typography>{t('oauthRequestDialog.authRedirectTitle')}</Typography>\n          ) : null}\n        </DialogTitle>\n\n        <DialogContent dividers classes={{ root: classes.contentList }}>\n          <List>\n            {requests.map(request => (\n              <LoginRequestListItem\n                key={request.provider.title}\n                request={request}\n                busy={busy}\n                setBusy={setBusy}\n              />\n            ))}\n          </List>\n        </DialogContent>\n      </main>\n\n      <DialogActions classes={{ root: classes.actionButtons }}>\n        <Button onClick={handleRejectAll}>\n          {t('oauthRequestDialog.rejectAll')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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"}