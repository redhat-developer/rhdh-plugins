{"version":3,"file":"TemplateGroups.esm.js","sources":["../../../../src/next/components/TemplateGroups/TemplateGroups.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Link, Progress } from '@backstage/core-components';\nimport { errorApiRef, IconComponent, useApi } from '@backstage/core-plugin-api';\nimport { useEntityList } from '@backstage/plugin-catalog-react';\nimport {\n  isTemplateEntityV1beta3,\n  TemplateEntityV1beta3,\n} from '@backstage/plugin-scaffolder-common';\nimport { TemplateGroupFilter } from '@backstage/plugin-scaffolder-react';\nimport Typography from '@material-ui/core/Typography';\nimport { ComponentType, useCallback, useEffect } from 'react';\n\nimport { TemplateGroup } from '../TemplateGroup/TemplateGroup';\n\n/**\n * @alpha\n */\nexport interface TemplateGroupsProps {\n  groups: TemplateGroupFilter[];\n  templateFilter?: (entity: TemplateEntityV1beta3) => boolean;\n  TemplateCardComponent?: ComponentType<{\n    template: TemplateEntityV1beta3;\n  }>;\n  onTemplateSelected?: (template: TemplateEntityV1beta3) => void;\n  additionalLinksForEntity?: (template: TemplateEntityV1beta3) => {\n    icon: IconComponent;\n    text: string;\n    url: string;\n  }[];\n}\n\n/**\n * @alpha\n */\nexport const TemplateGroups = (props: TemplateGroupsProps) => {\n  const { loading, error, entities } = useEntityList();\n  const { groups, templateFilter, TemplateCardComponent, onTemplateSelected } =\n    props;\n  const errorApi = useApi(errorApiRef);\n  const onSelected = useCallback(\n    (template: TemplateEntityV1beta3) => {\n      onTemplateSelected?.(template);\n    },\n    [onTemplateSelected],\n  );\n\n  useEffect(() => {\n    if (error) {\n      errorApi.post(error);\n    }\n  }, [error, errorApi]);\n\n  if (loading) {\n    return <Progress />;\n  }\n\n  if (error) {\n    return null;\n  }\n\n  if (!entities || !entities.length) {\n    return (\n      <Typography variant=\"body2\">\n        No templates found that match your filter. Learn more about{' '}\n        <Link to=\"https://backstage.io/docs/features/software-templates/adding-templates\">\n          adding templates\n        </Link>\n        .\n      </Typography>\n    );\n  }\n\n  return (\n    <>\n      {groups.map(({ title, filter }, index) => {\n        const templates = entities\n          .filter(isTemplateEntityV1beta3)\n          .filter(e => (templateFilter ? templateFilter(e) : true))\n          .filter(filter)\n          .map(template => {\n            const additionalLinks =\n              props.additionalLinksForEntity?.(template) ?? [];\n\n            return {\n              template,\n              additionalLinks,\n            };\n          });\n\n        return (\n          <TemplateGroup\n            key={index}\n            templates={templates}\n            title={title}\n            components={{ CardComponent: TemplateCardComponent }}\n            onSelected={onSelected}\n          />\n        );\n      })}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;AAgDO,MAAM,cAAA,GAAiB,CAAC,KAAA,KAA+B;AAC5D,EAAA,MAAM,EAAE,OAAA,EAAS,KAAA,EAAO,QAAA,KAAa,aAAA,EAAc;AACnD,EAAA,MAAM,EAAE,MAAA,EAAQ,cAAA,EAAgB,qBAAA,EAAuB,oBAAmB,GACxE,KAAA;AACF,EAAA,MAAM,QAAA,GAAW,OAAO,WAAW,CAAA;AACnC,EAAA,MAAM,UAAA,GAAa,WAAA;AAAA,IACjB,CAAC,QAAA,KAAoC;AACnC,MAAA,kBAAA,GAAqB,QAAQ,CAAA;AAAA,IAC/B,CAAA;AAAA,IACA,CAAC,kBAAkB;AAAA,GACrB;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,KAAA,EAAO;AACT,MAAA,QAAA,CAAS,KAAK,KAAK,CAAA;AAAA,IACrB;AAAA,EACF,CAAA,EAAG,CAAC,KAAA,EAAO,QAAQ,CAAC,CAAA;AAEpB,EAAA,IAAI,OAAA,EAAS;AACX,IAAA,2BAAQ,QAAA,EAAA,EAAS,CAAA;AAAA,EACnB;AAEA,EAAA,IAAI,KAAA,EAAO;AACT,IAAA,OAAO,IAAA;AAAA,EACT;AAEA,EAAA,IAAI,CAAC,QAAA,IAAY,CAAC,QAAA,CAAS,MAAA,EAAQ;AACjC,IAAA,uBACE,IAAA,CAAC,UAAA,EAAA,EAAW,OAAA,EAAQ,OAAA,EAAQ,QAAA,EAAA;AAAA,MAAA,6DAAA;AAAA,MACkC,GAAA;AAAA,sBAC5D,GAAA,CAAC,IAAA,EAAA,EAAK,EAAA,EAAG,wEAAA,EAAyE,QAAA,EAAA,kBAAA,EAElF,CAAA;AAAA,MAAO;AAAA,KAAA,EAET,CAAA;AAAA,EAEJ;AAEA,EAAA,uBACE,GAAA,CAAA,QAAA,EAAA,EACG,iBAAO,GAAA,CAAI,CAAC,EAAE,KAAA,EAAO,MAAA,IAAU,KAAA,KAAU;AACxC,IAAA,MAAM,YAAY,QAAA,CACf,MAAA,CAAO,uBAAuB,CAAA,CAC9B,OAAO,CAAA,CAAA,KAAM,cAAA,GAAiB,cAAA,CAAe,CAAC,IAAI,IAAK,CAAA,CACvD,OAAO,MAAM,CAAA,CACb,IAAI,CAAA,QAAA,KAAY;AACf,MAAA,MAAM,eAAA,GACJ,KAAA,CAAM,wBAAA,GAA2B,QAAQ,KAAK,EAAC;AAEjD,MAAA,OAAO;AAAA,QACL,QAAA;AAAA,QACA;AAAA,OACF;AAAA,IACF,CAAC,CAAA;AAEH,IAAA,uBACE,GAAA;AAAA,MAAC,aAAA;AAAA,MAAA;AAAA,QAEC,SAAA;AAAA,QACA,KAAA;AAAA,QACA,UAAA,EAAY,EAAE,aAAA,EAAe,qBAAA,EAAsB;AAAA,QACnD;AAAA,OAAA;AAAA,MAJK;AAAA,KAKP;AAAA,EAEJ,CAAC,CAAA,EACH,CAAA;AAEJ;;;;"}