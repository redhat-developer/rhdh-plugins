{"version":3,"file":"SecretWidget.esm.js","sources":["../../../../src/next/components/SecretWidget/SecretWidget.tsx"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WidgetProps } from '@rjsf/utils';\nimport { useTemplateSecrets } from '@backstage/plugin-scaffolder-react';\nimport TextField from '@material-ui/core/TextField';\nimport { ChangeEvent, useMemo, useState } from 'react';\nimport debounce from 'lodash/debounce';\n\n/**\n * Secret Widget for overriding the default password input widget\n * @alpha\n */\nexport const SecretWidget = (\n  props: Pick<\n    WidgetProps,\n    'name' | 'onChange' | 'schema' | 'required' | 'disabled'\n  >,\n) => {\n  const { setSecrets, secrets } = useTemplateSecrets();\n  const {\n    name,\n    onChange,\n    schema: { title, minLength, maxLength },\n    required,\n    disabled,\n  } = props;\n\n  const [localValue, setLocalValue] = useState(secrets[name] ?? '');\n\n  // Memoize the debounced function so it persists across re-renders\n  const debouncedSetSecrets = useMemo(\n    () =>\n      debounce((value: string) => {\n        setSecrets({ [name]: value });\n      }, 300),\n    [setSecrets, name],\n  );\n\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const newValue = e.target.value;\n    setLocalValue(newValue);\n    onChange(Array(newValue.length).fill('*').join(''));\n    debouncedSetSecrets(newValue);\n  };\n\n  return (\n    <TextField\n      id={title}\n      label={title}\n      aria-describedby={title}\n      onChange={handleChange}\n      value={localValue}\n      type=\"password\"\n      autoComplete=\"off\"\n      required={required}\n      disabled={disabled}\n      inputProps={{\n        minLength,\n        maxLength,\n      }}\n    />\n  );\n};\n"],"names":[],"mappings":";;;;;;AA0BO,MAAM,YAAA,GAAe,CAC1B,KAAA,KAIG;AACH,EAAA,MAAM,EAAE,UAAA,EAAY,OAAA,EAAQ,GAAI,kBAAA,EAAmB;AACnD,EAAA,MAAM;AAAA,IACJ,IAAA;AAAA,IACA,QAAA;AAAA,IACA,MAAA,EAAQ,EAAE,KAAA,EAAO,SAAA,EAAW,SAAA,EAAU;AAAA,IACtC,QAAA;AAAA,IACA;AAAA,GACF,GAAI,KAAA;AAEJ,EAAA,MAAM,CAAC,YAAY,aAAa,CAAA,GAAI,SAAS,OAAA,CAAQ,IAAI,KAAK,EAAE,CAAA;AAGhE,EAAA,MAAM,mBAAA,GAAsB,OAAA;AAAA,IAC1B,MACE,QAAA,CAAS,CAAC,KAAA,KAAkB;AAC1B,MAAA,UAAA,CAAW,EAAE,CAAC,IAAI,GAAG,OAAO,CAAA;AAAA,IAC9B,GAAG,GAAG,CAAA;AAAA,IACR,CAAC,YAAY,IAAI;AAAA,GACnB;AAEA,EAAA,MAAM,YAAA,GAAe,CAAC,CAAA,KAAqC;AACzD,IAAA,MAAM,QAAA,GAAW,EAAE,MAAA,CAAO,KAAA;AAC1B,IAAA,aAAA,CAAc,QAAQ,CAAA;AACtB,IAAA,QAAA,CAAS,KAAA,CAAM,SAAS,MAAM,CAAA,CAAE,KAAK,GAAG,CAAA,CAAE,IAAA,CAAK,EAAE,CAAC,CAAA;AAClD,IAAA,mBAAA,CAAoB,QAAQ,CAAA;AAAA,EAC9B,CAAA;AAEA,EAAA,uBACE,GAAA;AAAA,IAAC,SAAA;AAAA,IAAA;AAAA,MACC,EAAA,EAAI,KAAA;AAAA,MACJ,KAAA,EAAO,KAAA;AAAA,MACP,kBAAA,EAAkB,KAAA;AAAA,MAClB,QAAA,EAAU,YAAA;AAAA,MACV,KAAA,EAAO,UAAA;AAAA,MACP,IAAA,EAAK,UAAA;AAAA,MACL,YAAA,EAAa,KAAA;AAAA,MACb,QAAA;AAAA,MACA,QAAA;AAAA,MACA,UAAA,EAAY;AAAA,QACV,SAAA;AAAA,QACA;AAAA;AACF;AAAA,GACF;AAEJ;;;;"}