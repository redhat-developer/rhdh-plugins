{"version":3,"file":"VirtualizedListbox.esm.js","sources":["../../../src/components/fields/VirtualizedListbox.tsx"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  HTMLAttributes,\n  cloneElement,\n  createContext,\n  forwardRef,\n  useContext,\n  Children,\n} from 'react';\nimport { FixedSizeList, ListChildComponentProps } from 'react-window';\n\ntype HTMLDivProps = HTMLAttributes<HTMLDivElement>;\n\nconst renderRow = (props: ListChildComponentProps) => {\n  const { data, index, style } = props;\n  return cloneElement(data[index], { style });\n};\n\n// Context needed to keep Autocomplete working correctly : https://v4.mui.com/components/autocomplete/#Virtualize.tsx\nconst OuterElementContext = createContext<HTMLDivProps>({});\n\nconst OuterElementType = forwardRef<HTMLDivElement, HTMLDivProps>(\n  (props, ref) => {\n    const outerProps = useContext(OuterElementContext);\n    return <div ref={ref} {...props} {...outerProps} />;\n  },\n);\n\nexport const VirtualizedListbox = forwardRef<HTMLDivElement, HTMLDivProps>(\n  (props, ref) => {\n    const { children, ...other } = props;\n    const itemData = Children.toArray(children);\n    const itemCount = itemData.length;\n\n    const itemSize = 36;\n\n    const itemsToShow = Math.min(10, itemCount) + 0.5;\n    const height = itemsToShow * itemSize;\n\n    return (\n      <div ref={ref}>\n        <OuterElementContext.Provider value={other}>\n          <FixedSizeList\n            height={height}\n            itemData={itemData}\n            itemCount={itemCount}\n            itemSize={itemSize}\n            outerElementType={OuterElementType}\n            width=\"100%\"\n          >\n            {renderRow}\n          </FixedSizeList>\n        </OuterElementContext.Provider>\n      </div>\n    );\n  },\n);\n"],"names":[],"mappings":";;;;AA4BA,MAAM,SAAA,GAAY,CAAC,KAAA,KAAmC;AACpD,EAAA,MAAM,EAAE,IAAA,EAAM,KAAA,EAAO,KAAA,EAAM,GAAI,KAAA;AAC/B,EAAA,OAAO,aAAa,IAAA,CAAK,KAAK,CAAA,EAAG,EAAE,OAAO,CAAA;AAC5C,CAAA;AAGA,MAAM,mBAAA,GAAsB,aAAA,CAA4B,EAAE,CAAA;AAE1D,MAAM,gBAAA,GAAmB,UAAA;AAAA,EACvB,CAAC,OAAO,GAAA,KAAQ;AACd,IAAA,MAAM,UAAA,GAAa,WAAW,mBAAmB,CAAA;AACjD,IAAA,2BAAQ,KAAA,EAAA,EAAI,GAAA,EAAW,GAAG,KAAA,EAAQ,GAAG,UAAA,EAAY,CAAA;AAAA,EACnD;AACF,CAAA;AAEO,MAAM,kBAAA,GAAqB,UAAA;AAAA,EAChC,CAAC,OAAO,GAAA,KAAQ;AACd,IAAA,MAAM,EAAE,QAAA,EAAU,GAAG,KAAA,EAAM,GAAI,KAAA;AAC/B,IAAA,MAAM,QAAA,GAAW,QAAA,CAAS,OAAA,CAAQ,QAAQ,CAAA;AAC1C,IAAA,MAAM,YAAY,QAAA,CAAS,MAAA;AAE3B,IAAA,MAAM,QAAA,GAAW,EAAA;AAEjB,IAAA,MAAM,WAAA,GAAc,IAAA,CAAK,GAAA,CAAI,EAAA,EAAI,SAAS,CAAA,GAAI,GAAA;AAC9C,IAAA,MAAM,SAAS,WAAA,GAAc,QAAA;AAE7B,IAAA,uBACE,GAAA,CAAC,SAAI,GAAA,EACH,QAAA,kBAAA,GAAA,CAAC,oBAAoB,QAAA,EAApB,EAA6B,OAAO,KAAA,EACnC,QAAA,kBAAA,GAAA;AAAA,MAAC,aAAA;AAAA,MAAA;AAAA,QACC,MAAA;AAAA,QACA,QAAA;AAAA,QACA,SAAA;AAAA,QACA,QAAA;AAAA,QACA,gBAAA,EAAkB,gBAAA;AAAA,QAClB,KAAA,EAAM,MAAA;AAAA,QAEL,QAAA,EAAA;AAAA;AAAA,OAEL,CAAA,EACF,CAAA;AAAA,EAEJ;AACF;;;;"}