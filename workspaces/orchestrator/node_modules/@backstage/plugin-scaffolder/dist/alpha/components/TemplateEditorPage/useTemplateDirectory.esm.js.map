{"version":3,"file":"useTemplateDirectory.esm.js","sources":["../../../../src/alpha/components/TemplateEditorPage/useTemplateDirectory.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\nimport useAsyncRetry from 'react-use/esm/useAsyncRetry';\n\nimport {\n  WebFileSystemStore,\n  WebFileSystemAccess,\n  WebDirectoryAccess,\n  createExampleTemplate,\n} from '../../../lib/filesystem';\n\nexport function useTemplateDirectory(): {\n  directory?: WebDirectoryAccess;\n  loading: boolean;\n  error?: Error;\n  openDirectory: () => Promise<void>;\n  createDirectory: () => Promise<void>;\n  closeDirectory: () => Promise<void>;\n} {\n  const { value, loading, error, retry } = useAsyncRetry(async () => {\n    const directory = await WebFileSystemStore.getDirectory();\n    if (!directory) return undefined;\n    return WebFileSystemAccess.fromHandle(directory);\n  }, []);\n\n  const openDirectory = useCallback(() => {\n    return WebFileSystemAccess.requestDirectoryAccess()\n      .then(WebFileSystemStore.setDirectory)\n      .then(retry);\n  }, [retry]);\n\n  const createDirectory = useCallback(() => {\n    return WebFileSystemAccess.requestDirectoryAccess()\n      .then(createExampleTemplate)\n      .then(WebFileSystemStore.setDirectory)\n      .then(retry);\n  }, [retry]);\n\n  const closeDirectory = useCallback(() => {\n    return WebFileSystemStore.setDirectory(undefined).then(retry);\n  }, [retry]);\n\n  return {\n    directory: value,\n    loading,\n    error,\n    openDirectory,\n    createDirectory,\n    closeDirectory,\n  };\n}\n"],"names":[],"mappings":";;;;;;AA0BO,SAAS,oBAAA,GAOd;AACA,EAAA,MAAM,EAAE,KAAA,EAAO,OAAA,EAAS,OAAO,KAAA,EAAM,GAAI,cAAc,YAAY;AACjE,IAAA,MAAM,SAAA,GAAY,MAAM,kBAAA,CAAmB,YAAA,EAAa;AACxD,IAAA,IAAI,CAAC,WAAW,OAAO,MAAA;AACvB,IAAA,OAAO,mBAAA,CAAoB,WAAW,SAAS,CAAA;AAAA,EACjD,CAAA,EAAG,EAAE,CAAA;AAEL,EAAA,MAAM,aAAA,GAAgB,YAAY,MAAM;AACtC,IAAA,OAAO,mBAAA,CAAoB,wBAAuB,CAC/C,IAAA,CAAK,mBAAmB,YAAY,CAAA,CACpC,KAAK,KAAK,CAAA;AAAA,EACf,CAAA,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAA,MAAM,eAAA,GAAkB,YAAY,MAAM;AACxC,IAAA,OAAO,mBAAA,CAAoB,sBAAA,EAAuB,CAC/C,IAAA,CAAK,qBAAqB,CAAA,CAC1B,IAAA,CAAK,kBAAA,CAAmB,YAAY,CAAA,CACpC,IAAA,CAAK,KAAK,CAAA;AAAA,EACf,CAAA,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAA,MAAM,cAAA,GAAiB,YAAY,MAAM;AACvC,IAAA,OAAO,kBAAA,CAAmB,YAAA,CAAa,MAAS,CAAA,CAAE,KAAK,KAAK,CAAA;AAAA,EAC9D,CAAA,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAA,OAAO;AAAA,IACL,SAAA,EAAW,KAAA;AAAA,IACX,OAAA;AAAA,IACA,KAAA;AAAA,IACA,aAAA;AAAA,IACA,eAAA;AAAA,IACA;AAAA,GACF;AACF;;;;"}