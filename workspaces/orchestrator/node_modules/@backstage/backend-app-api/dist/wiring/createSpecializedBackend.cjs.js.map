{"version":3,"file":"createSpecializedBackend.cjs.js","sources":["../../src/wiring/createSpecializedBackend.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { coreServices } from '@backstage/backend-plugin-api';\nimport { BackstageBackend } from './BackstageBackend';\nimport { Backend, CreateSpecializedBackendOptions } from './types';\n\n/**\n * @public\n */\nexport function createSpecializedBackend(\n  options: CreateSpecializedBackendOptions,\n): Backend {\n  const exists = new Set<string>();\n  const duplicates = new Set<string>();\n  for (const { service } of options.defaultServiceFactories) {\n    if (exists.has(service.id)) {\n      duplicates.add(service.id);\n    } else {\n      exists.add(service.id);\n    }\n  }\n  if (duplicates.size > 0) {\n    const ids = Array.from(duplicates).join(', ');\n    throw new Error(`Duplicate service implementations provided for ${ids}`);\n  }\n  if (exists.has(coreServices.pluginMetadata.id)) {\n    throw new Error(\n      `The ${coreServices.pluginMetadata.id} service cannot be overridden`,\n    );\n  }\n\n  return new BackstageBackend(options.defaultServiceFactories);\n}\n"],"names":["coreServices","BackstageBackend"],"mappings":";;;;;AAuBO,SAAS,yBACd,OAAA,EACS;AACT,EAAA,MAAM,MAAA,uBAAa,GAAA,EAAY;AAC/B,EAAA,MAAM,UAAA,uBAAiB,GAAA,EAAY;AACnC,EAAA,KAAA,MAAW,EAAE,OAAA,EAAQ,IAAK,OAAA,CAAQ,uBAAA,EAAyB;AACzD,IAAA,IAAI,MAAA,CAAO,GAAA,CAAI,OAAA,CAAQ,EAAE,CAAA,EAAG;AAC1B,MAAA,UAAA,CAAW,GAAA,CAAI,QAAQ,EAAE,CAAA;AAAA,IAC3B,CAAA,MAAO;AACL,MAAA,MAAA,CAAO,GAAA,CAAI,QAAQ,EAAE,CAAA;AAAA,IACvB;AAAA,EACF;AACA,EAAA,IAAI,UAAA,CAAW,OAAO,CAAA,EAAG;AACvB,IAAA,MAAM,MAAM,KAAA,CAAM,IAAA,CAAK,UAAU,CAAA,CAAE,KAAK,IAAI,CAAA;AAC5C,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,+CAAA,EAAkD,GAAG,CAAA,CAAE,CAAA;AAAA,EACzE;AACA,EAAA,IAAI,MAAA,CAAO,GAAA,CAAIA,6BAAA,CAAa,cAAA,CAAe,EAAE,CAAA,EAAG;AAC9C,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,CAAA,IAAA,EAAOA,6BAAA,CAAa,cAAA,CAAe,EAAE,CAAA,6BAAA;AAAA,KACvC;AAAA,EACF;AAEA,EAAA,OAAO,IAAIC,iCAAA,CAAiB,OAAA,CAAQ,uBAAuB,CAAA;AAC7D;;;;"}