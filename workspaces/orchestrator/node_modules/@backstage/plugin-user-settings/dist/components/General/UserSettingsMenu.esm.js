import { jsxs, Fragment, jsx } from 'react/jsx-runtime';
import { useState } from 'react';
import IconButton from '@material-ui/core/IconButton';
import ListItemIcon from '@material-ui/core/ListItemIcon';
import Menu from '@material-ui/core/Menu';
import MenuItem from '@material-ui/core/MenuItem';
import SignOutIcon from '@material-ui/icons/MeetingRoom';
import MoreVertIcon from '@material-ui/icons/MoreVert';
import { useApi, errorApiRef, identityApiRef, useAnalytics } from '@backstage/core-plugin-api';
import { useTranslationRef } from '@backstage/frontend-plugin-api';
import { userSettingsTranslationRef } from '../../translation.esm.js';

const UserSettingsMenu = () => {
  const errorApi = useApi(errorApiRef);
  const identityApi = useApi(identityApiRef);
  const [open, setOpen] = useState(false);
  const [anchorEl, setAnchorEl] = useState(void 0);
  const { t } = useTranslationRef(userSettingsTranslationRef);
  const analytics = useAnalytics();
  const handleOpen = (event) => {
    setAnchorEl(event.currentTarget);
    setOpen(true);
  };
  const handleClose = () => {
    setAnchorEl(void 0);
    setOpen(false);
  };
  return /* @__PURE__ */ jsxs(Fragment, { children: [
    /* @__PURE__ */ jsx(
      IconButton,
      {
        "data-testid": "user-settings-menu",
        "aria-label": t("signOutMenu.moreIconTitle"),
        onClick: handleOpen,
        children: /* @__PURE__ */ jsx(MoreVertIcon, {})
      }
    ),
    /* @__PURE__ */ jsx(Menu, { anchorEl, open, onClose: handleClose, children: /* @__PURE__ */ jsxs(
      MenuItem,
      {
        "data-testid": "sign-out",
        onClick: () => {
          identityApi.signOut().catch((error) => errorApi.post(error));
          analytics.captureEvent("signOut", "success");
        },
        children: [
          /* @__PURE__ */ jsx(ListItemIcon, { children: /* @__PURE__ */ jsx(SignOutIcon, {}) }),
          t("signOutMenu.title")
        ]
      }
    ) })
  ] });
};

export { UserSettingsMenu };
//# sourceMappingURL=UserSettingsMenu.esm.js.map
