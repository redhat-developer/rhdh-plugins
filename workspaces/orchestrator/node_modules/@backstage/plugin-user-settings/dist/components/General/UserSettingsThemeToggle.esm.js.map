{"version":3,"file":"UserSettingsThemeToggle.esm.js","sources":["../../../src/components/General/UserSettingsThemeToggle.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MouseEvent, cloneElement } from 'react';\nimport useObservable from 'react-use/esm/useObservable';\nimport AutoIcon from '@material-ui/icons/BrightnessAuto';\nimport ToggleButton from '@material-ui/lab/ToggleButton';\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { appThemeApiRef, useApi } from '@backstage/core-plugin-api';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\nimport { userSettingsTranslationRef } from '../../translation';\n\ntype ThemeIconProps = {\n  id: string;\n  activeId: string | undefined;\n  icon: JSX.Element | undefined;\n};\n\nconst ThemeIcon = ({ id, activeId, icon }: ThemeIconProps) =>\n  icon ? (\n    cloneElement(icon, {\n      color: activeId === id ? 'primary' : undefined,\n    })\n  ) : (\n    <AutoIcon color={activeId === id ? 'primary' : undefined} />\n  );\n\ntype TooltipToggleButtonProps = {\n  children: JSX.Element;\n  title: string;\n  value: string;\n};\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    width: '100%',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingBottom: 8,\n    paddingRight: 16,\n  },\n  list: {\n    width: 'initial',\n    [theme.breakpoints.down('xs')]: {\n      width: '100%',\n      padding: `0 0 12px`,\n    },\n  },\n  listItemText: {\n    paddingRight: 0,\n    paddingLeft: 0,\n  },\n  listItemSecondaryAction: {\n    position: 'relative',\n    transform: 'unset',\n    top: 'auto',\n    right: 'auto',\n    paddingLeft: 16,\n    [theme.breakpoints.down('xs')]: {\n      paddingLeft: 0,\n    },\n  },\n}));\n\n// ToggleButtonGroup uses React.children.map instead of context\n// so wrapping with Tooltip breaks ToggleButton functionality.\nconst TooltipToggleButton = ({\n  children,\n  title,\n  value,\n  ...props\n}: TooltipToggleButtonProps) => (\n  <Tooltip placement=\"top\" arrow title={title}>\n    <ToggleButton value={value} {...props}>\n      {children}\n    </ToggleButton>\n  </Tooltip>\n);\n\n/** @public */\nexport const UserSettingsThemeToggle = () => {\n  const classes = useStyles();\n  const appThemeApi = useApi(appThemeApiRef);\n  const activeThemeId = useObservable(\n    appThemeApi.activeThemeId$(),\n    appThemeApi.getActiveThemeId(),\n  );\n\n  const themeIds = appThemeApi.getInstalledThemes();\n\n  const { t } = useTranslationRef(userSettingsTranslationRef);\n\n  const handleSetTheme = (\n    _event: MouseEvent<HTMLElement>,\n    newThemeId: string | undefined,\n  ) => {\n    if (themeIds.some(it => it.id === newThemeId)) {\n      appThemeApi.setActiveThemeId(newThemeId);\n    } else {\n      appThemeApi.setActiveThemeId(undefined);\n    }\n  };\n\n  return (\n    <ListItem\n      className={classes.list}\n      classes={{ container: classes.container }}\n    >\n      <ListItemText\n        className={classes.listItemText}\n        primary={t('themeToggle.title')}\n        secondary={t('themeToggle.description')}\n      />\n      <ListItemSecondaryAction className={classes.listItemSecondaryAction}>\n        <ToggleButtonGroup\n          exclusive\n          size=\"small\"\n          value={activeThemeId ?? 'auto'}\n          onChange={handleSetTheme}\n        >\n          {themeIds.map(theme => {\n            const themeId = theme.id;\n            const themeIcon = theme.icon;\n            const themeTitle =\n              theme.title ||\n              (themeId === 'light' || themeId === 'dark'\n                ? t(`themeToggle.names.${themeId}`)\n                : themeId);\n            return (\n              <TooltipToggleButton\n                key={themeId}\n                title={t('themeToggle.select', { theme: themeTitle })}\n                value={themeId}\n              >\n                <>\n                  {themeTitle}&nbsp;\n                  <ThemeIcon\n                    id={themeId}\n                    icon={themeIcon}\n                    activeId={activeThemeId}\n                  />\n                </>\n              </TooltipToggleButton>\n            );\n          })}\n          <Tooltip placement=\"top\" arrow title={t('themeToggle.selectAuto')}>\n            <ToggleButton value=\"auto\" selected={activeThemeId === undefined}>\n              {t('themeToggle.names.auto')}&nbsp;\n              <AutoIcon\n                color={activeThemeId === undefined ? 'primary' : undefined}\n              />\n            </ToggleButton>\n          </Tooltip>\n        </ToggleButtonGroup>\n      </ListItemSecondaryAction>\n    </ListItem>\n  );\n};\n"],"names":[],"mappings":"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"}