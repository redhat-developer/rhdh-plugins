{"version":3,"file":"useSupportConfig.esm.js","sources":["../../src/hooks/useSupportConfig.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApiHolder, configApiRef } from '@backstage/core-plugin-api';\nimport { coreComponentsTranslationRef } from '../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport type SupportItemLink = {\n  url: string;\n  title: string;\n};\n\nexport type SupportItem = {\n  title: string;\n  icon?: string;\n  links: SupportItemLink[];\n};\n\nexport type SupportConfig = {\n  url: string;\n  items: SupportItem[];\n};\n\nconst useDefaultSupportConfig = () => {\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n  return {\n    url: 'https://github.com/backstage/backstage/issues',\n    items: [\n      {\n        title: t('supportConfig.default.title'),\n        icon: 'warning',\n        links: [\n          {\n            // TODO: Update to dedicated support page on backstage.io/docs\n            title: t('supportConfig.default.linkTitle'),\n            url: 'https://github.com/backstage/backstage/blob/master/app-config.yaml',\n          },\n        ],\n      },\n    ],\n  };\n};\n\nexport function useSupportConfig(): SupportConfig {\n  const apiHolder = useApiHolder();\n  const config = apiHolder.get(configApiRef);\n  const supportConfig = config?.getOptionalConfig('app.support');\n  const defaultSupportConfig = useDefaultSupportConfig();\n\n  if (!supportConfig) {\n    return defaultSupportConfig;\n  }\n\n  return {\n    url: supportConfig.getString('url'),\n    items: supportConfig.getConfigArray('items').flatMap(itemConf => ({\n      title: itemConf.getString('title'),\n      icon: itemConf.getOptionalString('icon'),\n      links: (itemConf.getOptionalConfigArray('links') ?? []).flatMap(\n        linkConf => ({\n          url: linkConf.getString('url'),\n          title: linkConf.getOptionalString('title') ?? '',\n        }),\n      ),\n    })),\n  };\n}\n"],"names":[],"mappings":";;;;AAoCA,MAAM,0BAA0B,MAAM;AACpC,EAAA,MAAM,EAAE,CAAA,EAAE,GAAI,iBAAA,CAAkB,4BAA4B,CAAA;AAC5D,EAAA,OAAO;AAAA,IACL,GAAA,EAAK,+CAAA;AAAA,IACL,KAAA,EAAO;AAAA,MACL;AAAA,QACE,KAAA,EAAO,EAAE,6BAA6B,CAAA;AAAA,QACtC,IAAA,EAAM,SAAA;AAAA,QACN,KAAA,EAAO;AAAA,UACL;AAAA;AAAA,YAEE,KAAA,EAAO,EAAE,iCAAiC,CAAA;AAAA,YAC1C,GAAA,EAAK;AAAA;AACP;AACF;AACF;AACF,GACF;AACF,CAAA;AAEO,SAAS,gBAAA,GAAkC;AAChD,EAAA,MAAM,YAAY,YAAA,EAAa;AAC/B,EAAA,MAAM,MAAA,GAAS,SAAA,CAAU,GAAA,CAAI,YAAY,CAAA;AACzC,EAAA,MAAM,aAAA,GAAgB,MAAA,EAAQ,iBAAA,CAAkB,aAAa,CAAA;AAC7D,EAAA,MAAM,uBAAuB,uBAAA,EAAwB;AAErD,EAAA,IAAI,CAAC,aAAA,EAAe;AAClB,IAAA,OAAO,oBAAA;AAAA,EACT;AAEA,EAAA,OAAO;AAAA,IACL,GAAA,EAAK,aAAA,CAAc,SAAA,CAAU,KAAK,CAAA;AAAA,IAClC,OAAO,aAAA,CAAc,cAAA,CAAe,OAAO,CAAA,CAAE,QAAQ,CAAA,QAAA,MAAa;AAAA,MAChE,KAAA,EAAO,QAAA,CAAS,SAAA,CAAU,OAAO,CAAA;AAAA,MACjC,IAAA,EAAM,QAAA,CAAS,iBAAA,CAAkB,MAAM,CAAA;AAAA,MACvC,QAAQ,QAAA,CAAS,sBAAA,CAAuB,OAAO,CAAA,IAAK,EAAC,EAAG,OAAA;AAAA,QACtD,CAAA,QAAA,MAAa;AAAA,UACX,GAAA,EAAK,QAAA,CAAS,SAAA,CAAU,KAAK,CAAA;AAAA,UAC7B,KAAA,EAAO,QAAA,CAAS,iBAAA,CAAkB,OAAO,CAAA,IAAK;AAAA,SAChD;AAAA;AACF,KACF,CAAE;AAAA,GACJ;AACF;;;;"}