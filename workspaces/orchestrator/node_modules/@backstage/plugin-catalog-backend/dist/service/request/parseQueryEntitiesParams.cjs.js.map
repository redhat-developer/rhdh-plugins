{"version":3,"file":"parseQueryEntitiesParams.cjs.js","sources":["../../../src/service/request/parseQueryEntitiesParams.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  QueryEntitiesCursorRequest,\n  QueryEntitiesInitialRequest,\n  QueryEntitiesRequest,\n} from '../../catalog/types';\nimport { decodeCursor } from '../util';\nimport { parseEntityFilterParams } from './parseEntityFilterParams';\nimport { parseEntityOrderFieldParams } from './parseEntityOrderFieldParams';\nimport { parseEntityTransformParams } from './parseEntityTransformParams';\nimport { GetEntitiesByQuery } from '../../schema/openapi';\n\nexport function parseQueryEntitiesParams(\n  params: GetEntitiesByQuery['query'],\n): Omit<QueryEntitiesRequest, 'credentials' | 'limit'> {\n  const fields = parseEntityTransformParams(params);\n\n  if (params.cursor) {\n    const decodedCursor = decodeCursor(params.cursor);\n    const response: Omit<QueryEntitiesCursorRequest, 'credentials'> = {\n      cursor: decodedCursor,\n      fields,\n    };\n    return response;\n  }\n\n  const filter = parseEntityFilterParams(params);\n  const orderFields = parseEntityOrderFieldParams(params);\n\n  const response: Omit<QueryEntitiesInitialRequest, 'credentials'> = {\n    fields,\n    filter,\n    orderFields,\n    fullTextFilter: {\n      term: params.fullTextFilterTerm || '',\n      fields: params.fullTextFilterFields,\n    },\n  };\n\n  return response;\n}\n"],"names":["parseEntityTransformParams","decodeCursor","response","parseEntityFilterParams","parseEntityOrderFieldParams"],"mappings":";;;;;;;AA2BO,SAAS,yBACd,MAAA,EACqD;AACrD,EAAA,MAAM,MAAA,GAASA,sDAA2B,MAAM,CAAA;AAEhD,EAAA,IAAI,OAAO,MAAA,EAAQ;AACjB,IAAA,MAAM,aAAA,GAAgBC,iBAAA,CAAa,MAAA,CAAO,MAAM,CAAA;AAChD,IAAA,MAAMC,SAAAA,GAA4D;AAAA,MAChE,MAAA,EAAQ,aAAA;AAAA,MACR;AAAA,KACF;AACA,IAAA,OAAOA,SAAAA;AAAA,EACT;AAEA,EAAA,MAAM,MAAA,GAASC,gDAAwB,MAAM,CAAA;AAC7C,EAAA,MAAM,WAAA,GAAcC,wDAA4B,MAAM,CAAA;AAEtD,EAAA,MAAM,QAAA,GAA6D;AAAA,IACjE,MAAA;AAAA,IACA,MAAA;AAAA,IACA,WAAA;AAAA,IACA,cAAA,EAAgB;AAAA,MACd,IAAA,EAAM,OAAO,kBAAA,IAAsB,EAAA;AAAA,MACnC,QAAQ,MAAA,CAAO;AAAA;AACjB,GACF;AAEA,EAAA,OAAO,QAAA;AACT;;;;"}