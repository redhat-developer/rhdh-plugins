{"version":3,"file":"process.cjs.js","sources":["../../../src/service/response/process.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { EntitiesResponseItems } from '../../catalog/types';\n\nexport function processRawEntitiesResult(\n  serializedEntities: (string | null)[],\n  transform?: (entity: Entity) => Entity,\n): EntitiesResponseItems {\n  if (transform) {\n    return {\n      type: 'object',\n      entities: serializedEntities.map(e =>\n        e !== null ? transform(JSON.parse(e)) : e,\n      ),\n    };\n  }\n\n  return {\n    type: 'raw',\n    entities: serializedEntities,\n  };\n}\n\nexport function processEntitiesResponseItems(\n  response: EntitiesResponseItems,\n  transform?: (entity: Entity) => Entity,\n): EntitiesResponseItems {\n  if (!transform) {\n    return response;\n  }\n  if (response.type === 'raw') {\n    return processRawEntitiesResult(response.entities, transform);\n  }\n  return {\n    type: 'object',\n    entities: response.entities.map(e => (e !== null ? transform(e) : e)),\n  };\n}\n\nexport function entitiesResponseToObjects(\n  response: EntitiesResponseItems,\n): (Entity | null)[] {\n  if (response.type === 'object') {\n    return response.entities;\n  }\n  return response.entities.map(e => (e !== null ? JSON.parse(e) : e));\n}\n"],"names":[],"mappings":";;AAmBO,SAAS,wBAAA,CACd,oBACA,SAAA,EACuB;AACvB,EAAA,IAAI,SAAA,EAAW;AACb,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,QAAA;AAAA,MACN,UAAU,kBAAA,CAAmB,GAAA;AAAA,QAAI,CAAA,CAAA,KAC/B,MAAM,IAAA,GAAO,SAAA,CAAU,KAAK,KAAA,CAAM,CAAC,CAAC,CAAA,GAAI;AAAA;AAC1C,KACF;AAAA,EACF;AAEA,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,KAAA;AAAA,IACN,QAAA,EAAU;AAAA,GACZ;AACF;AAEO,SAAS,4BAAA,CACd,UACA,SAAA,EACuB;AACvB,EAAA,IAAI,CAAC,SAAA,EAAW;AACd,IAAA,OAAO,QAAA;AAAA,EACT;AACA,EAAA,IAAI,QAAA,CAAS,SAAS,KAAA,EAAO;AAC3B,IAAA,OAAO,wBAAA,CAAyB,QAAA,CAAS,QAAA,EAAU,SAAS,CAAA;AAAA,EAC9D;AACA,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,QAAA;AAAA,IACN,QAAA,EAAU,QAAA,CAAS,QAAA,CAAS,GAAA,CAAI,CAAA,CAAA,KAAM,MAAM,IAAA,GAAO,SAAA,CAAU,CAAC,CAAA,GAAI,CAAE;AAAA,GACtE;AACF;AAEO,SAAS,0BACd,QAAA,EACmB;AACnB,EAAA,IAAI,QAAA,CAAS,SAAS,QAAA,EAAU;AAC9B,IAAA,OAAO,QAAA,CAAS,QAAA;AAAA,EAClB;AACA,EAAA,OAAO,QAAA,CAAS,QAAA,CAAS,GAAA,CAAI,CAAA,CAAA,KAAM,CAAA,KAAM,OAAO,IAAA,CAAK,KAAA,CAAM,CAAC,CAAA,GAAI,CAAE,CAAA;AACpE;;;;;;"}