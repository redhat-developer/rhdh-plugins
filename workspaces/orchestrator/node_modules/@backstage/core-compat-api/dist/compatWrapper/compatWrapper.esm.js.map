{"version":3,"file":"compatWrapper.esm.js","sources":["../../src/compatWrapper/compatWrapper.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useVersionedContext } from '@backstage/version-bridge';\nimport { ReactNode } from 'react';\nimport { BackwardsCompatProvider } from './BackwardsCompatProvider';\nimport { ForwardsCompatProvider } from './ForwardsCompatProvider';\nimport { appTreeApiRef, useApiHolder } from '@backstage/frontend-plugin-api';\n\nfunction BidirectionalCompatProvider(props: { children: ReactNode }) {\n  const isInOldApp = useVersionedContext<{ 1: unknown }>('app-context');\n  const isInNewApp = Boolean(useApiHolder().get(appTreeApiRef));\n\n  if (isInNewApp && !isInOldApp) {\n    return <BackwardsCompatProvider {...props} />;\n  }\n\n  if (isInOldApp && !isInNewApp) {\n    return <ForwardsCompatProvider {...props} />;\n  }\n\n  return props.children;\n}\n\n/**\n * Wraps a React element in a bidirectional compatibility provider, allow APIs\n * from `@backstage/core-plugin-api` to be used in an app from `@backstage/frontend-app-api`,\n * and APIs from `@backstage/frontend-plugin-api` to be used in an app from `@backstage/core-app-api`.\n *\n * @public\n */\nexport function compatWrapper(element: ReactNode) {\n  return <BidirectionalCompatProvider>{element}</BidirectionalCompatProvider>;\n}\n"],"names":[],"mappings":";;;;;;AAsBA,SAAS,4BAA4B,KAAA,EAAgC;AACnE,EAAA,MAAM,UAAA,GAAa,oBAAoC,aAAa,CAAA;AACpE,EAAA,MAAM,aAAa,OAAA,CAAQ,YAAA,EAAa,CAAE,GAAA,CAAI,aAAa,CAAC,CAAA;AAE5D,EAAA,IAAI,UAAA,IAAc,CAAC,UAAA,EAAY;AAC7B,IAAA,uBAAO,GAAA,CAAC,uBAAA,EAAA,EAAyB,GAAG,KAAA,EAAO,CAAA;AAAA,EAC7C;AAEA,EAAA,IAAI,UAAA,IAAc,CAAC,UAAA,EAAY;AAC7B,IAAA,uBAAO,GAAA,CAAC,sBAAA,EAAA,EAAwB,GAAG,KAAA,EAAO,CAAA;AAAA,EAC5C;AAEA,EAAA,OAAO,KAAA,CAAM,QAAA;AACf;AASO,SAAS,cAAc,OAAA,EAAoB;AAChD,EAAA,uBAAO,GAAA,CAAC,+BAA6B,QAAA,EAAA,OAAA,EAAQ,CAAA;AAC/C;;;;"}