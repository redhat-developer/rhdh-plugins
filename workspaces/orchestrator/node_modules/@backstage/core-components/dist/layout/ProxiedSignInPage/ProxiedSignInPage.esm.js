import { jsx } from 'react/jsx-runtime';
import { useApi, discoveryApiRef } from '@backstage/core-plugin-api';
import { useAsync, useMountEffect } from '@react-hookz/web';
import { ErrorPanel } from '../../components/ErrorPanel/ErrorPanel.esm.js';
import { Progress } from '../../components/Progress/Progress.esm.js';
import { ProxiedSignInIdentity } from './ProxiedSignInIdentity.esm.js';
import { coreComponentsTranslationRef } from '../../translation.esm.js';
import { useTranslationRef } from '@backstage/core-plugin-api/alpha';

const ProxiedSignInPage = (props) => {
  const discoveryApi = useApi(discoveryApiRef);
  const { t } = useTranslationRef(coreComponentsTranslationRef);
  const [{ status, error }, { execute }] = useAsync(async () => {
    const identity = new ProxiedSignInIdentity({
      provider: props.provider,
      discoveryApi,
      headers: props.headers
    });
    await identity.start();
    props.onSignInSuccess(identity);
  });
  useMountEffect(execute);
  if (status === "loading") {
    return /* @__PURE__ */ jsx(Progress, {});
  } else if (error) {
    return props.ErrorComponent ? /* @__PURE__ */ jsx(props.ErrorComponent, { error }) : /* @__PURE__ */ jsx(ErrorPanel, { title: t("proxiedSignInPage.title"), error });
  }
  return null;
};

export { ProxiedSignInPage };
//# sourceMappingURL=ProxiedSignInPage.esm.js.map
