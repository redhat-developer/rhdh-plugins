{"version":3,"file":"WarningPanel.esm.js","sources":["../../../src/components/WarningPanel/WarningPanel.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles, darken, lighten, Theme } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport ErrorOutline from '@material-ui/icons/ErrorOutline';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { ReactNode } from 'react';\nimport { MarkdownContent } from '../MarkdownContent';\n\nconst getWarningTextColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: Theme,\n) => {\n  const getColor = theme.palette.type === 'light' ? darken : lighten;\n  return getColor(theme.palette[severity].light, 0.6);\n};\n\nconst getWarningBackgroundColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: Theme,\n) => {\n  const getBackgroundColor = theme.palette.type === 'light' ? lighten : darken;\n  return getBackgroundColor(theme.palette[severity].light, 0.9);\n};\n\nconst useErrorOutlineStyles = makeStyles(theme => ({\n  root: {\n    marginRight: theme.spacing(1),\n    fill: ({ severity }: WarningProps) =>\n      getWarningTextColor(\n        severity as NonNullable<WarningProps['severity']>,\n        theme,\n      ),\n  },\n}));\n\nconst ErrorOutlineStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ErrorOutline classes={classes} />;\n};\nconst ExpandMoreIconStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ExpandMoreIcon classes={classes} />;\n};\n\nexport type WarningPanelClassKey =\n  | 'panel'\n  | 'summary'\n  | 'summaryText'\n  | 'message'\n  | 'details';\n\nconst useStyles = makeStyles(\n  theme => ({\n    panel: {\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      verticalAlign: 'middle',\n    },\n    summary: {\n      display: 'flex',\n      flexDirection: 'row',\n    },\n    summaryText: {\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      fontWeight: theme.typography.fontWeightBold,\n    },\n    markdownContent: {\n      '& p': {\n        display: 'inline',\n      },\n    },\n    message: {\n      width: '100%',\n      display: 'block',\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n    },\n    details: {\n      width: '100%',\n      display: 'block',\n      color: theme.palette.textContrast,\n      backgroundColor: theme.palette.background.default,\n      border: `1px solid ${theme.palette.border}`,\n      padding: theme.spacing(2.0),\n      fontFamily: 'sans-serif',\n    },\n  }),\n  { name: 'BackstageWarningPanel' },\n);\n\nexport type WarningProps = {\n  title?: string;\n  severity?: 'warning' | 'error' | 'info';\n  titleFormat?: string;\n  message?: ReactNode;\n  defaultExpanded?: boolean;\n  children?: ReactNode;\n};\n\nconst capitalize = (s: string) => {\n  return s.charAt(0).toLocaleUpperCase('en-US') + s.slice(1);\n};\n\n/**\n * Show a user friendly error message to a user similar to\n * ErrorPanel except that the warning panel only shows the warning message to\n * the user.\n *\n * @param severity - Ability to change the severity of the alert. Default value\n *        \"warning\"\n * @param title - A title for the warning. If not supplied, \"Warning\" will be\n *        used.\n * @param message - Optional more detailed user-friendly message elaborating on\n *        the cause of the error.\n * @param children - Objects to provide context, such as a stack trace or detailed\n *        error reporting. Will be available inside an unfolded accordion.\n */\nexport function WarningPanel(props: WarningProps) {\n  const {\n    severity = 'warning',\n    title,\n    titleFormat,\n    message,\n    children,\n    defaultExpanded,\n  } = props;\n  const classes = useStyles({ severity });\n\n  // If no severity or title provided, the heading will read simply \"Warning\"\n  const subTitle = capitalize(severity) + (title ? `: ${title}` : '');\n\n  return (\n    <Accordion\n      defaultExpanded={defaultExpanded ?? false}\n      className={classes.panel}\n      role=\"alert\"\n    >\n      <AccordionSummary\n        expandIcon={<ExpandMoreIconStyled severity={severity} />}\n        className={classes.summary}\n      >\n        <ErrorOutlineStyled severity={severity} />\n        <Typography className={classes.summaryText} variant=\"subtitle1\">\n          {titleFormat === 'markdown' ? (\n            <MarkdownContent\n              content={subTitle}\n              className={classes.markdownContent}\n            />\n          ) : (\n            subTitle\n          )}\n        </Typography>\n      </AccordionSummary>\n      {(message || children) && (\n        <AccordionDetails>\n          <Grid container>\n            {message && (\n              <Grid item xs={12}>\n                <Typography className={classes.message} variant=\"body1\">\n                  {message}\n                </Typography>\n              </Grid>\n            )}\n            {children && (\n              <Grid item xs={12} className={classes.details}>\n                {children}\n              </Grid>\n            )}\n          </Grid>\n        </AccordionDetails>\n      )}\n    </Accordion>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;AA2BA,MAAM,mBAAA,GAAsB,CAC1B,QAAA,EACA,KAAA,KACG;AACH,EAAA,MAAM,QAAA,GAAW,KAAA,CAAM,OAAA,CAAQ,IAAA,KAAS,UAAU,MAAA,GAAS,OAAA;AAC3D,EAAA,OAAO,SAAS,KAAA,CAAM,OAAA,CAAQ,QAAQ,CAAA,CAAE,OAAO,GAAG,CAAA;AACpD,CAAA;AAEA,MAAM,yBAAA,GAA4B,CAChC,QAAA,EACA,KAAA,KACG;AACH,EAAA,MAAM,kBAAA,GAAqB,KAAA,CAAM,OAAA,CAAQ,IAAA,KAAS,UAAU,OAAA,GAAU,MAAA;AACtE,EAAA,OAAO,mBAAmB,KAAA,CAAM,OAAA,CAAQ,QAAQ,CAAA,CAAE,OAAO,GAAG,CAAA;AAC9D,CAAA;AAEA,MAAM,qBAAA,GAAwB,WAAW,CAAA,KAAA,MAAU;AAAA,EACjD,IAAA,EAAM;AAAA,IACJ,WAAA,EAAa,KAAA,CAAM,OAAA,CAAQ,CAAC,CAAA;AAAA,IAC5B,IAAA,EAAM,CAAC,EAAE,QAAA,EAAS,KAChB,mBAAA;AAAA,MACE,QAAA;AAAA,MACA;AAAA;AACF;AAEN,CAAA,CAAE,CAAA;AAEF,MAAM,kBAAA,GAAqB,CAAC,EAAE,QAAA,EAAS,KAAsC;AAC3E,EAAA,MAAM,OAAA,GAAU,qBAAA,CAAsB,EAAE,QAAA,EAAU,CAAA;AAClD,EAAA,uBAAO,GAAA,CAAC,gBAAa,OAAA,EAAkB,CAAA;AACzC,CAAA;AACA,MAAM,oBAAA,GAAuB,CAAC,EAAE,QAAA,EAAS,KAAsC;AAC7E,EAAA,MAAM,OAAA,GAAU,qBAAA,CAAsB,EAAE,QAAA,EAAU,CAAA;AAClD,EAAA,uBAAO,GAAA,CAAC,kBAAe,OAAA,EAAkB,CAAA;AAC3C,CAAA;AASA,MAAM,SAAA,GAAY,UAAA;AAAA,EAChB,CAAA,KAAA,MAAU;AAAA,IACR,KAAA,EAAO;AAAA,MACL,eAAA,EAAiB,CAAC,EAAE,QAAA,EAAS,KAC3B,yBAAA;AAAA,QACE,QAAA;AAAA,QACA;AAAA,OACF;AAAA,MACF,KAAA,EAAO,CAAC,EAAE,QAAA,EAAS,KACjB,mBAAA;AAAA,QACE,QAAA;AAAA,QACA;AAAA,OACF;AAAA,MACF,aAAA,EAAe;AAAA,KACjB;AAAA,IACA,OAAA,EAAS;AAAA,MACP,OAAA,EAAS,MAAA;AAAA,MACT,aAAA,EAAe;AAAA,KACjB;AAAA,IACA,WAAA,EAAa;AAAA,MACX,KAAA,EAAO,CAAC,EAAE,QAAA,EAAS,KACjB,mBAAA;AAAA,QACE,QAAA;AAAA,QACA;AAAA,OACF;AAAA,MACF,UAAA,EAAY,MAAM,UAAA,CAAW;AAAA,KAC/B;AAAA,IACA,eAAA,EAAiB;AAAA,MACf,KAAA,EAAO;AAAA,QACL,OAAA,EAAS;AAAA;AACX,KACF;AAAA,IACA,OAAA,EAAS;AAAA,MACP,KAAA,EAAO,MAAA;AAAA,MACP,OAAA,EAAS,OAAA;AAAA,MACT,KAAA,EAAO,CAAC,EAAE,QAAA,EAAS,KACjB,mBAAA;AAAA,QACE,QAAA;AAAA,QACA;AAAA,OACF;AAAA,MACF,eAAA,EAAiB,CAAC,EAAE,QAAA,EAAS,KAC3B,yBAAA;AAAA,QACE,QAAA;AAAA,QACA;AAAA;AACF,KACJ;AAAA,IACA,OAAA,EAAS;AAAA,MACP,KAAA,EAAO,MAAA;AAAA,MACP,OAAA,EAAS,OAAA;AAAA,MACT,KAAA,EAAO,MAAM,OAAA,CAAQ,YAAA;AAAA,MACrB,eAAA,EAAiB,KAAA,CAAM,OAAA,CAAQ,UAAA,CAAW,OAAA;AAAA,MAC1C,MAAA,EAAQ,CAAA,UAAA,EAAa,KAAA,CAAM,OAAA,CAAQ,MAAM,CAAA,CAAA;AAAA,MACzC,OAAA,EAAS,KAAA,CAAM,OAAA,CAAQ,CAAG,CAAA;AAAA,MAC1B,UAAA,EAAY;AAAA;AACd,GACF,CAAA;AAAA,EACA,EAAE,MAAM,uBAAA;AACV,CAAA;AAWA,MAAM,UAAA,GAAa,CAAC,CAAA,KAAc;AAChC,EAAA,OAAO,CAAA,CAAE,OAAO,CAAC,CAAA,CAAE,kBAAkB,OAAO,CAAA,GAAI,CAAA,CAAE,KAAA,CAAM,CAAC,CAAA;AAC3D,CAAA;AAgBO,SAAS,aAAa,KAAA,EAAqB;AAChD,EAAA,MAAM;AAAA,IACJ,QAAA,GAAW,SAAA;AAAA,IACX,KAAA;AAAA,IACA,WAAA;AAAA,IACA,OAAA;AAAA,IACA,QAAA;AAAA,IACA;AAAA,GACF,GAAI,KAAA;AACJ,EAAA,MAAM,OAAA,GAAU,SAAA,CAAU,EAAE,QAAA,EAAU,CAAA;AAGtC,EAAA,MAAM,WAAW,UAAA,CAAW,QAAQ,KAAK,KAAA,GAAQ,CAAA,EAAA,EAAK,KAAK,CAAA,CAAA,GAAK,EAAA,CAAA;AAEhE,EAAA,uBACE,IAAA;AAAA,IAAC,SAAA;AAAA,IAAA;AAAA,MACC,iBAAiB,eAAA,IAAmB,KAAA;AAAA,MACpC,WAAW,OAAA,CAAQ,KAAA;AAAA,MACnB,IAAA,EAAK,OAAA;AAAA,MAEL,QAAA,EAAA;AAAA,wBAAA,IAAA;AAAA,UAAC,gBAAA;AAAA,UAAA;AAAA,YACC,UAAA,kBAAY,GAAA,CAAC,oBAAA,EAAA,EAAqB,QAAA,EAAoB,CAAA;AAAA,YACtD,WAAW,OAAA,CAAQ,OAAA;AAAA,YAEnB,QAAA,EAAA;AAAA,8BAAA,GAAA,CAAC,sBAAmB,QAAA,EAAoB,CAAA;AAAA,8BACxC,GAAA,CAAC,cAAW,SAAA,EAAW,OAAA,CAAQ,aAAa,OAAA,EAAQ,WAAA,EACjD,0BAAgB,UAAA,mBACf,GAAA;AAAA,gBAAC,eAAA;AAAA,gBAAA;AAAA,kBACC,OAAA,EAAS,QAAA;AAAA,kBACT,WAAW,OAAA,CAAQ;AAAA;AAAA,kBAGrB,QAAA,EAEJ;AAAA;AAAA;AAAA,SACF;AAAA,QAAA,CACE,WAAW,QAAA,qBACX,GAAA,CAAC,oBACC,QAAA,kBAAA,IAAA,CAAC,IAAA,EAAA,EAAK,WAAS,IAAA,EACZ,QAAA,EAAA;AAAA,UAAA,OAAA,oBACC,GAAA,CAAC,IAAA,EAAA,EAAK,IAAA,EAAI,IAAA,EAAC,IAAI,EAAA,EACb,QAAA,kBAAA,GAAA,CAAC,UAAA,EAAA,EAAW,SAAA,EAAW,OAAA,CAAQ,OAAA,EAAS,OAAA,EAAQ,OAAA,EAC7C,mBACH,CAAA,EACF,CAAA;AAAA,UAED,QAAA,oBACC,GAAA,CAAC,IAAA,EAAA,EAAK,IAAA,EAAI,IAAA,EAAC,IAAI,EAAA,EAAI,SAAA,EAAW,OAAA,CAAQ,OAAA,EACnC,QAAA,EACH;AAAA,SAAA,EAEJ,CAAA,EACF;AAAA;AAAA;AAAA,GAEJ;AAEJ;;;;"}