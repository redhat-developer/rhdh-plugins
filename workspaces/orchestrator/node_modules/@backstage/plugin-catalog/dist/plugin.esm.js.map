{"version":3,"file":"plugin.esm.js","sources":["../src/plugin.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CatalogClient } from '@backstage/catalog-client';\nimport { Entity } from '@backstage/catalog-model';\nimport {\n  catalogApiRef,\n  entityPresentationApiRef,\n  entityRouteRef,\n  starredEntitiesApiRef,\n} from '@backstage/plugin-catalog-react';\nimport {\n  createComponentRouteRef,\n  createFromTemplateRouteRef,\n  unregisterRedirectRouteRef,\n  viewTechDocRouteRef,\n  rootRouteRef,\n} from './routes';\nimport {\n  createApiFactory,\n  createComponentExtension,\n  createPlugin,\n  createRoutableExtension,\n  discoveryApiRef,\n  fetchApiRef,\n  storageApiRef,\n} from '@backstage/core-plugin-api';\nimport {\n  createSearchResultListItemExtension,\n  SearchResultListItemExtensionProps,\n} from '@backstage/plugin-search-react';\nimport { DefaultStarredEntitiesApi } from './apis';\nimport { AboutCardProps } from './components/AboutCard';\nimport { DefaultCatalogPageProps } from './components/CatalogPage';\nimport { DependencyOfComponentsCardProps } from './components/DependencyOfComponentsCard';\nimport { DependsOnComponentsCardProps } from './components/DependsOnComponentsCard';\nimport { DependsOnResourcesCardProps } from './components/DependsOnResourcesCard';\nimport { HasComponentsCardProps } from './components/HasComponentsCard';\nimport { HasResourcesCardProps } from './components/HasResourcesCard';\nimport { HasSubcomponentsCardProps } from './components/HasSubcomponentsCard';\nimport { HasSubdomainsCardProps } from './components/HasSubdomainsCard';\nimport { HasSystemsCardProps } from './components/HasSystemsCard';\nimport { RelatedEntitiesCardProps } from './components/RelatedEntitiesCard';\nimport { CatalogSearchResultListItemProps } from './components/CatalogSearchResultListItem';\nimport { DefaultEntityPresentationApi } from './apis/EntityPresentationApi';\n\n/** @public */\nexport const catalogPlugin = createPlugin({\n  id: 'catalog',\n  apis: [\n    createApiFactory({\n      api: catalogApiRef,\n      deps: {\n        discoveryApi: discoveryApiRef,\n        fetchApi: fetchApiRef,\n      },\n      factory: ({ discoveryApi, fetchApi }) =>\n        new CatalogClient({ discoveryApi, fetchApi }),\n    }),\n    createApiFactory({\n      api: starredEntitiesApiRef,\n      deps: { storageApi: storageApiRef },\n      factory: ({ storageApi }) =>\n        new DefaultStarredEntitiesApi({ storageApi }),\n    }),\n    createApiFactory({\n      api: entityPresentationApiRef,\n      deps: { catalogApi: catalogApiRef },\n      factory: ({ catalogApi }) =>\n        DefaultEntityPresentationApi.create({ catalogApi }),\n    }),\n  ],\n  routes: {\n    catalogIndex: rootRouteRef,\n    catalogEntity: entityRouteRef,\n  },\n  externalRoutes: {\n    createComponent: createComponentRouteRef,\n    viewTechDoc: viewTechDocRouteRef,\n    createFromTemplate: createFromTemplateRouteRef,\n    unregisterRedirect: unregisterRedirectRouteRef,\n  },\n});\n\n/** @public */\nexport const CatalogIndexPage: (props: DefaultCatalogPageProps) => JSX.Element =\n  catalogPlugin.provide(\n    createRoutableExtension({\n      name: 'CatalogIndexPage',\n      component: () =>\n        import('./components/CatalogPage').then(m => m.CatalogPage),\n      mountPoint: rootRouteRef,\n    }),\n  );\n\n/** @public */\nexport const CatalogEntityPage: () => JSX.Element = catalogPlugin.provide(\n  createRoutableExtension({\n    name: 'CatalogEntityPage',\n    component: () =>\n      import('./components/CatalogEntityPage').then(m => m.CatalogEntityPage),\n    mountPoint: entityRouteRef,\n  }),\n);\n\n/**\n * An example About card to show at the top of entity pages.\n *\n * @public\n * @remarks\n *\n * This card collects some high level information about the entity, but is just\n * an example component. Many organizations will want to replace it with a\n * custom card that is more tailored to their specific needs. The card itself is\n * not extremely customizable; feel free to make a copy of it as a starting\n * point if you like.\n */\nexport const EntityAboutCard: (props: AboutCardProps) => JSX.Element =\n  catalogPlugin.provide(\n    createComponentExtension({\n      name: 'EntityAboutCard',\n      component: {\n        lazy: () => import('./components/AboutCard').then(m => m.AboutCard),\n      },\n    }),\n  );\n\n/** @public */\nexport const EntityLinksCard = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityLinksCard',\n    component: {\n      lazy: () =>\n        import('./components/EntityLinksCard').then(m => m.EntityLinksCard),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityLabelsCard = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityLabelsCard',\n    component: {\n      lazy: () =>\n        import('./components/EntityLabelsCard').then(m => m.EntityLabelsCard),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityHasSystemsCard: (props: HasSystemsCardProps) => JSX.Element =\n  catalogPlugin.provide(\n    createComponentExtension({\n      name: 'EntityHasSystemsCard',\n      component: {\n        lazy: () =>\n          import('./components/HasSystemsCard').then(m => m.HasSystemsCard),\n      },\n    }),\n  );\n\n/** @public */\nexport const EntityHasComponentsCard: (\n  props: HasComponentsCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityHasComponentsCard',\n    component: {\n      lazy: () =>\n        import('./components/HasComponentsCard').then(m => m.HasComponentsCard),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityHasSubcomponentsCard: (\n  props: HasSubcomponentsCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityHasSubcomponentsCard',\n    component: {\n      lazy: () =>\n        import('./components/HasSubcomponentsCard').then(\n          m => m.HasSubcomponentsCard,\n        ),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityHasSubdomainsCard: (\n  props: HasSubdomainsCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityHasSubdomainsCard',\n    component: {\n      lazy: () =>\n        import('./components/HasSubdomainsCard').then(m => m.HasSubdomainsCard),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityHasResourcesCard: (\n  props: HasResourcesCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityHasResourcesCard',\n    component: {\n      lazy: () =>\n        import('./components/HasResourcesCard').then(m => m.HasResourcesCard),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityDependsOnComponentsCard: (\n  props: DependsOnComponentsCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityDependsOnComponentsCard',\n    component: {\n      lazy: () =>\n        import('./components/DependsOnComponentsCard').then(\n          m => m.DependsOnComponentsCard,\n        ),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityDependencyOfComponentsCard: (\n  props: DependencyOfComponentsCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityDependencyOfComponentsCard',\n    component: {\n      lazy: () =>\n        import('./components/DependencyOfComponentsCard').then(\n          m => m.DependencyOfComponentsCard,\n        ),\n    },\n  }),\n);\n\n/** @public */\nexport const EntityDependsOnResourcesCard: (\n  props: DependsOnResourcesCardProps,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'EntityDependsOnResourcesCard',\n    component: {\n      lazy: () =>\n        import('./components/DependsOnResourcesCard').then(\n          m => m.DependsOnResourcesCard,\n        ),\n    },\n  }),\n);\n\n/** @public */\nexport const RelatedEntitiesCard: <T extends Entity>(\n  props: RelatedEntitiesCardProps<T>,\n) => JSX.Element = catalogPlugin.provide(\n  createComponentExtension({\n    name: 'RelatedEntitiesCard',\n    component: {\n      lazy: () =>\n        import('./components/RelatedEntitiesCard').then(\n          m => m.RelatedEntitiesCard,\n        ),\n    },\n  }),\n);\n\n/** @public */\nexport const CatalogSearchResultListItem: (\n  props: SearchResultListItemExtensionProps<CatalogSearchResultListItemProps>,\n) => JSX.Element | null = catalogPlugin.provide(\n  createSearchResultListItemExtension({\n    name: 'CatalogSearchResultListItem',\n    component: () =>\n      import('./components/CatalogSearchResultListItem').then(\n        m => m.CatalogSearchResultListItem,\n      ),\n    predicate: result => result.type === 'software-catalog',\n  }),\n);\n"],"names":[],"mappings":"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"}