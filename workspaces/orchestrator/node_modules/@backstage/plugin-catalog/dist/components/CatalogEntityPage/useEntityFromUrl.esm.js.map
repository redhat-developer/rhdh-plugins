{"version":3,"file":"useEntityFromUrl.esm.js","sources":["../../../src/components/CatalogEntityPage/useEntityFromUrl.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  errorApiRef,\n  useApi,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport {\n  catalogApiRef,\n  EntityLoadingStatus,\n  entityRouteRef,\n} from '@backstage/plugin-catalog-react';\nimport { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport useAsyncRetry from 'react-use/esm/useAsyncRetry';\n\nexport const useEntityFromUrl = (): EntityLoadingStatus => {\n  const { kind, namespace, name } = useRouteRefParams(entityRouteRef);\n  const navigate = useNavigate();\n  const errorApi = useApi(errorApiRef);\n  const catalogApi = useApi(catalogApiRef);\n\n  const {\n    value: entity,\n    error,\n    loading,\n    retry: refresh,\n  } = useAsyncRetry(\n    () => catalogApi.getEntityByRef({ kind, namespace, name }),\n    [catalogApi, kind, namespace, name],\n  );\n\n  useEffect(() => {\n    if (!name) {\n      errorApi.post(new Error('No name provided!'));\n      navigate('/');\n    }\n  }, [errorApi, navigate, error, loading, entity, name]);\n\n  return { entity, loading, error, refresh };\n};\n"],"names":[],"mappings":";;;;;;AA8BO,MAAM,mBAAmB,MAA2B;AACzD,EAAA,MAAM,EAAE,IAAA,EAAM,SAAA,EAAW,IAAA,EAAK,GAAI,kBAAkB,cAAc,CAAA;AAClE,EAAA,MAAM,WAAW,WAAA,EAAY;AAC7B,EAAA,MAAM,QAAA,GAAW,OAAO,WAAW,CAAA;AACnC,EAAA,MAAM,UAAA,GAAa,OAAO,aAAa,CAAA;AAEvC,EAAA,MAAM;AAAA,IACJ,KAAA,EAAO,MAAA;AAAA,IACP,KAAA;AAAA,IACA,OAAA;AAAA,IACA,KAAA,EAAO;AAAA,GACT,GAAI,aAAA;AAAA,IACF,MAAM,UAAA,CAAW,cAAA,CAAe,EAAE,IAAA,EAAM,SAAA,EAAW,MAAM,CAAA;AAAA,IACzD,CAAC,UAAA,EAAY,IAAA,EAAM,SAAA,EAAW,IAAI;AAAA,GACpC;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,CAAC,IAAA,EAAM;AACT,MAAA,QAAA,CAAS,IAAA,CAAK,IAAI,KAAA,CAAM,mBAAmB,CAAC,CAAA;AAC5C,MAAA,QAAA,CAAS,GAAG,CAAA;AAAA,IACd;AAAA,EACF,CAAA,EAAG,CAAC,QAAA,EAAU,QAAA,EAAU,OAAO,OAAA,EAAS,MAAA,EAAQ,IAAI,CAAC,CAAA;AAErD,EAAA,OAAO,EAAE,MAAA,EAAQ,OAAA,EAAS,KAAA,EAAO,OAAA,EAAQ;AAC3C;;;;"}