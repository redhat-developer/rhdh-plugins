{"version":3,"file":"entityCards.esm.js","sources":["../../src/alpha/entityCards.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  EntityIconLinkBlueprint,\n  EntityCardBlueprint,\n} from '@backstage/plugin-catalog-react/alpha';\nimport { compatWrapper } from '@backstage/core-compat-api';\nimport { createExtensionInput } from '@backstage/frontend-plugin-api';\nimport {\n  HeaderIconLinkRow,\n  IconLinkVerticalProps,\n} from '@backstage/core-components';\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport { buildFilterFn } from './filter/FilterWrapper';\n\nexport const catalogAboutEntityCard = EntityCardBlueprint.makeWithOverrides({\n  name: 'about',\n  inputs: {\n    iconLinks: createExtensionInput([\n      EntityIconLinkBlueprint.dataRefs.filterFunction.optional(),\n      EntityIconLinkBlueprint.dataRefs.filterExpression.optional(),\n      EntityIconLinkBlueprint.dataRefs.useProps,\n    ]),\n  },\n  factory(originalFactory, { inputs }) {\n    function Subheader() {\n      const { entity } = useEntity();\n      // The \"useProps\" functions may be calling other hooks, so we need to\n      // call them in a component function to avoid breaking the rules of hooks.\n      const links = inputs.iconLinks.reduce((rest, iconLink) => {\n        const props = iconLink.get(EntityIconLinkBlueprint.dataRefs.useProps)();\n        const filter = buildFilterFn(\n          iconLink.get(EntityIconLinkBlueprint.dataRefs.filterFunction),\n          iconLink.get(EntityIconLinkBlueprint.dataRefs.filterExpression),\n        );\n        if (filter(entity)) {\n          return [...rest, props];\n        }\n        return rest;\n      }, new Array<IconLinkVerticalProps>());\n      return links.length ? <HeaderIconLinkRow links={links} /> : null;\n    }\n    return originalFactory({\n      type: 'info',\n      filter: {\n        $not: {\n          kind: { $in: ['user', 'group'] },\n        },\n      },\n      async loader() {\n        const { InternalAboutCard } = await import(\n          '../components/AboutCard/AboutCard'\n        );\n        return compatWrapper(\n          <InternalAboutCard variant=\"gridItem\" subheader={<Subheader />} />,\n        );\n      },\n    });\n  },\n});\n\nexport const catalogLinksEntityCard = EntityCardBlueprint.make({\n  name: 'links',\n  params: {\n    type: 'info',\n    filter: { 'metadata.links': { $exists: true } },\n    loader: async () =>\n      import('../components/EntityLinksCard').then(m =>\n        compatWrapper(<m.EntityLinksCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogLabelsEntityCard = EntityCardBlueprint.make({\n  name: 'labels',\n  params: {\n    type: 'info',\n    filter: { 'metadata.labels': { $exists: true } },\n    loader: async () =>\n      import('../components/EntityLabelsCard').then(m =>\n        compatWrapper(<m.EntityLabelsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogDependsOnComponentsEntityCard = EntityCardBlueprint.make({\n  name: 'depends-on-components',\n  params: {\n    filter: { kind: 'component' },\n    loader: async () =>\n      import('../components/DependsOnComponentsCard').then(m =>\n        compatWrapper(<m.DependsOnComponentsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogDependsOnResourcesEntityCard = EntityCardBlueprint.make({\n  name: 'depends-on-resources',\n  params: {\n    filter: { kind: 'component' },\n    loader: async () =>\n      import('../components/DependsOnResourcesCard').then(m =>\n        compatWrapper(<m.DependsOnResourcesCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogHasComponentsEntityCard = EntityCardBlueprint.make({\n  name: 'has-components',\n  params: {\n    filter: { kind: 'system' },\n    loader: async () =>\n      import('../components/HasComponentsCard').then(m =>\n        compatWrapper(<m.HasComponentsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogHasResourcesEntityCard = EntityCardBlueprint.make({\n  name: 'has-resources',\n  params: {\n    filter: { kind: 'system' },\n    loader: async () =>\n      import('../components/HasResourcesCard').then(m =>\n        compatWrapper(<m.HasResourcesCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogHasSubcomponentsEntityCard = EntityCardBlueprint.make({\n  name: 'has-subcomponents',\n  params: {\n    filter: { kind: 'component' },\n    loader: async () =>\n      import('../components/HasSubcomponentsCard').then(m =>\n        compatWrapper(<m.HasSubcomponentsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogHasSubdomainsEntityCard = EntityCardBlueprint.make({\n  name: 'has-subdomains',\n  params: {\n    filter: { kind: 'domain' },\n    loader: async () =>\n      import('../components/HasSubdomainsCard').then(m =>\n        compatWrapper(<m.HasSubdomainsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport const catalogHasSystemsEntityCard = EntityCardBlueprint.make({\n  name: 'has-systems',\n  params: {\n    filter: { kind: 'domain' },\n    loader: async () =>\n      import('../components/HasSystemsCard').then(m =>\n        compatWrapper(<m.HasSystemsCard variant=\"gridItem\" />),\n      ),\n  },\n});\n\nexport default [\n  catalogAboutEntityCard,\n  catalogLinksEntityCard,\n  catalogLabelsEntityCard,\n  catalogDependsOnComponentsEntityCard,\n  catalogDependsOnResourcesEntityCard,\n  catalogHasComponentsEntityCard,\n  catalogHasResourcesEntityCard,\n  catalogHasSubcomponentsEntityCard,\n  catalogHasSubdomainsEntityCard,\n  catalogHasSystemsEntityCard,\n];\n"],"names":[],"mappings":"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"}