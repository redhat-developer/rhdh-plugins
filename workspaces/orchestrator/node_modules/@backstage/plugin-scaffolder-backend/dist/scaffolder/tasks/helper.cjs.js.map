{"version":3,"file":"helper.cjs.js","sources":["../../../src/scaffolder/tasks/helper.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Config, readDurationFromConfig } from '@backstage/config';\nimport { HumanDuration } from '@backstage/types';\n\nimport { isArray } from 'lodash';\nimport { Schema } from 'jsonschema';\n\n/**\n * Returns true if the input is not `false`, `undefined`, `null`, `\"\"`, `0`, or\n * `[]`. This behavior is based on the behavior of handlebars, see\n * https://handlebarsjs.com/guide/builtin-helpers.html#if\n */\nexport function isTruthy(value: any): boolean {\n  return isArray(value) ? value.length > 0 : !!value;\n}\n\nexport function generateExampleOutput(schema: Schema): unknown {\n  const { examples } = schema as { examples?: unknown };\n  if (examples && Array.isArray(examples)) {\n    return examples[0];\n  }\n  if (schema.type === 'object') {\n    return Object.fromEntries(\n      Object.entries(schema.properties ?? {}).map(([key, value]) => [\n        key,\n        generateExampleOutput(value as Schema),\n      ]),\n    );\n  } else if (schema.type === 'array') {\n    const [firstSchema] = [schema.items]?.flat();\n    if (firstSchema) {\n      return [generateExampleOutput(firstSchema as Schema)];\n    }\n    return [];\n  } else if (schema.type === 'string') {\n    return '<example>';\n  } else if (schema.type === 'number') {\n    return 0;\n  } else if (schema.type === 'boolean') {\n    return false;\n  }\n  return '<unknown>';\n}\n\nexport const readDuration = (\n  config: Config | undefined,\n  key: string,\n  defaultValue: HumanDuration,\n) => {\n  if (config?.has(key)) {\n    return readDurationFromConfig(config, { key });\n  }\n  return defaultValue;\n};\n"],"names":["isArray","config","readDurationFromConfig"],"mappings":";;;;;AA2BO,SAAS,SAAS,KAAA,EAAqB;AAC5C,EAAA,OAAOA,eAAQ,KAAK,CAAA,GAAI,MAAM,MAAA,GAAS,CAAA,GAAI,CAAC,CAAC,KAAA;AAC/C;AAEO,SAAS,sBAAsB,MAAA,EAAyB;AAC7D,EAAA,MAAM,EAAE,UAAS,GAAI,MAAA;AACrB,EAAA,IAAI,QAAA,IAAY,KAAA,CAAM,OAAA,CAAQ,QAAQ,CAAA,EAAG;AACvC,IAAA,OAAO,SAAS,CAAC,CAAA;AAAA,EACnB;AACA,EAAA,IAAI,MAAA,CAAO,SAAS,QAAA,EAAU;AAC5B,IAAA,OAAO,MAAA,CAAO,WAAA;AAAA,MACZ,MAAA,CAAO,OAAA,CAAQ,MAAA,CAAO,UAAA,IAAc,EAAE,CAAA,CAAE,GAAA,CAAI,CAAC,CAAC,GAAA,EAAK,KAAK,CAAA,KAAM;AAAA,QAC5D,GAAA;AAAA,QACA,sBAAsB,KAAe;AAAA,OACtC;AAAA,KACH;AAAA,EACF,CAAA,MAAA,IAAW,MAAA,CAAO,IAAA,KAAS,OAAA,EAAS;AAClC,IAAA,MAAM,CAAC,WAAW,CAAA,GAAI,CAAC,MAAA,CAAO,KAAK,GAAG,IAAA,EAAK;AAC3C,IAAA,IAAI,WAAA,EAAa;AACf,MAAA,OAAO,CAAC,qBAAA,CAAsB,WAAqB,CAAC,CAAA;AAAA,IACtD;AACA,IAAA,OAAO,EAAC;AAAA,EACV,CAAA,MAAA,IAAW,MAAA,CAAO,IAAA,KAAS,QAAA,EAAU;AACnC,IAAA,OAAO,WAAA;AAAA,EACT,CAAA,MAAA,IAAW,MAAA,CAAO,IAAA,KAAS,QAAA,EAAU;AACnC,IAAA,OAAO,CAAA;AAAA,EACT,CAAA,MAAA,IAAW,MAAA,CAAO,IAAA,KAAS,SAAA,EAAW;AACpC,IAAA,OAAO,KAAA;AAAA,EACT;AACA,EAAA,OAAO,WAAA;AACT;AAEO,MAAM,YAAA,GAAe,CAC1BC,QAAA,EACA,GAAA,EACA,YAAA,KACG;AACH,EAAA,IAAIA,QAAA,EAAQ,GAAA,CAAI,GAAG,CAAA,EAAG;AACpB,IAAA,OAAOC,6BAAA,CAAuBD,QAAA,EAAQ,EAAE,GAAA,EAAK,CAAA;AAAA,EAC/C;AACA,EAAA,OAAO,YAAA;AACT;;;;;;"}