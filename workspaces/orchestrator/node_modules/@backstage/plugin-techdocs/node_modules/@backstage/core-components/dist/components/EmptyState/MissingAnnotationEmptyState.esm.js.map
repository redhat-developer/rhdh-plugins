{"version":3,"file":"MissingAnnotationEmptyState.esm.js","sources":["../../../src/components/EmptyState/MissingAnnotationEmptyState.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\n\nimport { CodeSnippet } from '../CodeSnippet';\nimport { Link } from '../Link';\nimport { EmptyState } from './EmptyState';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\nimport { coreComponentsTranslationRef } from '../../translation';\n\nconst COMPONENT_YAML_TEMPLATE = `apiVersion: backstage.io/v1alpha1\nkind: Component\nmetadata:\n  name: example\n  description: example.com\n  annotations:\n    ANNOTATION: value\nspec:\n  type: website\n  lifecycle: production\n  owner: user:guest`;\n\nconst ANNOTATION_REGEXP = /^.*ANNOTATION.*$/m;\nconst ANNOTATION_YAML = COMPONENT_YAML_TEMPLATE.match(ANNOTATION_REGEXP)![0];\nconst ANNOTATION_LINE = COMPONENT_YAML_TEMPLATE.split('\\n').findIndex(line =>\n  ANNOTATION_REGEXP.test(line),\n);\n\ntype Props = {\n  annotation: string | string[];\n  readMoreUrl?: string;\n};\n\nconst useStyles = makeStyles(\n  theme => ({\n    code: {\n      borderRadius: 6,\n      margin: theme.spacing(2, 0),\n      background:\n        theme.palette.type === 'dark' ? '#444' : theme.palette.common.white,\n    },\n  }),\n  { name: 'BackstageMissingAnnotationEmptyState' },\n);\n\nfunction generateLineNumbers(lineCount: number) {\n  return Array.from(Array(lineCount + 1).keys(), i => i + ANNOTATION_LINE);\n}\n\nfunction generateComponentYaml(annotations: string[]) {\n  const annotationYaml = annotations\n    .map(ann => ANNOTATION_YAML.replace('ANNOTATION', ann))\n    .join('\\n');\n  return COMPONENT_YAML_TEMPLATE.replace(ANNOTATION_YAML, annotationYaml);\n}\n\nfunction useGenerateDescription(annotations: string[]) {\n  const isSingular = annotations.length <= 1;\n  return (\n    <>\n      The {isSingular ? 'annotation' : 'annotations'}{' '}\n      {annotations\n        .map(ann => <code>{ann}</code>)\n        .reduce((prev, curr) => (\n          <>\n            {prev}, {curr}\n          </>\n        ))}{' '}\n      {isSingular ? 'is' : 'are'} missing. You need to add the{' '}\n      {isSingular ? 'annotation' : 'annotations'} to your component if you want\n      to enable this tool.\n    </>\n  );\n}\n\n/**\n * @public\n * @deprecated This component is deprecated, please use {@link @backstage/plugin-catalog-react#MissingAnnotationEmptyState} instead\n */\nexport function MissingAnnotationEmptyState(props: Props) {\n  const { annotation, readMoreUrl } = props;\n  const annotations = Array.isArray(annotation) ? annotation : [annotation];\n  const url =\n    readMoreUrl ||\n    'https://backstage.io/docs/features/software-catalog/well-known-annotations';\n  const classes = useStyles();\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  return (\n    <EmptyState\n      missing=\"field\"\n      title={t('emptyState.missingAnnotation.title')}\n      description={useGenerateDescription(annotations)}\n      action={\n        <>\n          <Typography variant=\"body1\">\n            {t('emptyState.missingAnnotation.actionTitle')}\n          </Typography>\n          <Box className={classes.code}>\n            <CodeSnippet\n              text={generateComponentYaml(annotations)}\n              language=\"yaml\"\n              showLineNumbers\n              highlightedNumbers={generateLineNumbers(annotations.length)}\n              customStyle={{ background: 'inherit', fontSize: '115%' }}\n            />\n          </Box>\n          <Button color=\"primary\" component={Link} to={url}>\n            {t('emptyState.missingAnnotation.readMore')}\n          </Button>\n        </>\n      }\n    />\n  );\n}\n"],"names":[],"mappings":"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"}