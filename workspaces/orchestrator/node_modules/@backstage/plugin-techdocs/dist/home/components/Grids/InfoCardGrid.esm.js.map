{"version":3,"file":"InfoCardGrid.esm.js","sources":["../../../../src/home/components/Grids/InfoCardGrid.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport useAsync from 'react-use/esm/useAsync';\nimport { Entity, stringifyEntityRef } from '@backstage/catalog-model';\nimport { useApi, useRouteRef, configApiRef } from '@backstage/core-plugin-api';\nimport {\n  ItemCardGrid,\n  InfoCard,\n  Link,\n  Progress,\n} from '@backstage/core-components';\nimport {\n  EntityRefPresentationSnapshot,\n  entityPresentationApiRef,\n} from '@backstage/plugin-catalog-react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { rootDocsRouteRef } from '../../../routes';\nimport { toLowerMaybe } from '../../../helpers';\n\n/** @public */\nexport type InfoCardGridClassKey = 'linkSpacer' | 'readMoreLink';\n\nconst useStyles = makeStyles(\n  theme => ({\n    linkSpacer: {\n      paddingTop: theme.spacing(0.2),\n    },\n    readMoreLink: {\n      paddingTop: theme.spacing(0.2),\n    },\n  }),\n  { name: 'BackstageInfoCardGrid' },\n);\n\n/**\n * Props for {@link InfoCardGrid}\n *\n * @public\n */\nexport type InfoCardGridProps = {\n  entities: Entity[] | undefined;\n  linkContent?: string | JSX.Element;\n  linkDestination?: (entity: Entity) => string | undefined;\n};\n\n/**\n * Component which accepts a list of entities and renders a info card for each entity\n *\n * @public\n */\nexport const InfoCardGrid = (props: InfoCardGridProps) => {\n  const { entities, linkContent, linkDestination } = props;\n  const classes = useStyles();\n  const getRouteToReaderPageFor = useRouteRef(rootDocsRouteRef);\n  const config = useApi(configApiRef);\n  const linkRoute = (entity: Entity) => {\n    if (linkDestination) {\n      const destination = linkDestination(entity);\n      if (destination) {\n        return destination;\n      }\n    }\n    return getRouteToReaderPageFor({\n      namespace: toLowerMaybe(entity.metadata.namespace ?? 'default', config),\n      kind: toLowerMaybe(entity.kind, config),\n      name: toLowerMaybe(entity.metadata.name, config),\n    });\n  };\n  const entityPresentationApi = useApi(entityPresentationApiRef);\n  const { value: entityRefToPresentation, loading } = useAsync(async () => {\n    return new Map<string, EntityRefPresentationSnapshot>(\n      await Promise.all(\n        entities?.map(async entity => {\n          const presentation = await entityPresentationApi.forEntity(entity)\n            .promise;\n          return [stringifyEntityRef(entity), presentation] as [\n            string,\n            EntityRefPresentationSnapshot,\n          ];\n        }) || [],\n      ),\n    );\n  });\n  if (loading) return <Progress />;\n  if (!entities || !entities?.length) return null;\n  return (\n    <ItemCardGrid data-testid=\"info-card-container\">\n      {entities.map(entity => (\n        <InfoCard\n          key={entity.metadata.name}\n          data-testid={entity?.metadata?.title}\n          title={\n            entityRefToPresentation?.get(stringifyEntityRef(entity))\n              ?.primaryTitle\n          }\n        >\n          <div>{entity?.metadata?.description}</div>\n          <div className={classes.linkSpacer} />\n          <Link\n            to={linkRoute(entity)}\n            className={classes.readMoreLink}\n            data-testid=\"read-docs-link\"\n          >\n            {linkContent || 'Read Docs'}\n          </Link>\n        </InfoCard>\n      ))}\n    </ItemCardGrid>\n  );\n};\n"],"names":[],"mappings":"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"}