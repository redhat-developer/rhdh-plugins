{"version":3,"file":"TechDocsStateIndicator.esm.js","sources":["../../../src/reader/components/TechDocsStateIndicator.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Alert from '@material-ui/lab/Alert';\n\nimport { TechDocsBuildLogs } from './TechDocsBuildLogs';\nimport { TechDocsNotFound } from './TechDocsNotFound';\nimport { useTechDocsReader } from './TechDocsReaderProvider';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    marginBottom: theme.spacing(2),\n  },\n  message: {\n    // `word-break: break-word` is deprecated, but gives legacy support to browsers not supporting `overflow-wrap` yet\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/word-break\n    wordBreak: 'break-word',\n    overflowWrap: 'anywhere',\n  },\n}));\n\nexport const TechDocsStateIndicator = () => {\n  let StateAlert: JSX.Element | null = null;\n  const classes = useStyles();\n\n  const {\n    state,\n    contentReload,\n    contentErrorMessage,\n    syncErrorMessage,\n    buildLog,\n  } = useTechDocsReader();\n\n  if (state === 'INITIAL_BUILD') {\n    StateAlert = (\n      <Alert\n        classes={{ root: classes.root }}\n        variant=\"outlined\"\n        severity=\"info\"\n        icon={<CircularProgress size=\"24px\" />}\n        action={<TechDocsBuildLogs buildLog={buildLog} />}\n      >\n        Documentation is accessed for the first time and is being prepared. The\n        subsequent loads are much faster.\n      </Alert>\n    );\n  }\n\n  if (state === 'CONTENT_STALE_REFRESHING') {\n    StateAlert = (\n      <Alert\n        variant=\"outlined\"\n        severity=\"info\"\n        icon={<CircularProgress size=\"24px\" />}\n        action={<TechDocsBuildLogs buildLog={buildLog} />}\n        classes={{ root: classes.root }}\n      >\n        A newer version of this documentation is being prepared and will be\n        available shortly.\n      </Alert>\n    );\n  }\n\n  if (state === 'CONTENT_STALE_READY') {\n    StateAlert = (\n      <Alert\n        variant=\"outlined\"\n        severity=\"success\"\n        action={\n          <Button color=\"inherit\" onClick={() => contentReload()}>\n            Refresh\n          </Button>\n        }\n        classes={{ root: classes.root }}\n      >\n        A newer version of this documentation is now available, please refresh\n        to view.\n      </Alert>\n    );\n  }\n\n  if (state === 'CONTENT_STALE_ERROR') {\n    StateAlert = (\n      <Alert\n        variant=\"outlined\"\n        severity=\"error\"\n        action={<TechDocsBuildLogs buildLog={buildLog} />}\n        classes={{ root: classes.root, message: classes.message }}\n      >\n        Building a newer version of this documentation failed.{' '}\n        {syncErrorMessage}\n      </Alert>\n    );\n  }\n\n  if (state === 'CONTENT_NOT_FOUND') {\n    StateAlert = (\n      <>\n        {syncErrorMessage && (\n          <Alert\n            variant=\"outlined\"\n            severity=\"error\"\n            action={<TechDocsBuildLogs buildLog={buildLog} />}\n            classes={{ root: classes.root, message: classes.message }}\n          >\n            Building a newer version of this documentation failed.{' '}\n            {syncErrorMessage}\n          </Alert>\n        )}\n        <TechDocsNotFound errorMessage={contentErrorMessage} />\n      </>\n    );\n  }\n\n  return StateAlert;\n};\n"],"names":[],"mappings":"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"}