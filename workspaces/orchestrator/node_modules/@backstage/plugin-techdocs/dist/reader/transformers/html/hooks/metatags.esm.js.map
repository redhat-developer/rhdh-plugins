{"version":3,"file":"metatags.esm.js","sources":["../../../../../src/reader/transformers/html/hooks/metatags.ts"],"sourcesContent":["/*\n * Copyright 2025 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { UponSanitizeElementHook } from 'dompurify';\nimport { isElement } from '../utils';\n\n/**\n * Checks if a meta tag is a refresh redirect tag that should be allowed.\n * These tags are required for the TechDocs redirect feature.\n */\nconst isAllowedMetaRefreshTag = (element: Element): boolean => {\n  const httpEquiv = element.getAttribute('http-equiv');\n  const content = element.getAttribute('content');\n\n  return httpEquiv === 'refresh' && content?.includes('url=') === true;\n};\n\n/**\n * Removes unsafe meta tags from the DOM while preserving allowed refresh redirect tags.\n * Only meta tags used for page refreshing/redirects are allowed as they are required\n * for the TechDocs redirect feature.\n */\nexport const removeUnsafeMetaTags: UponSanitizeElementHook = (node, data) => {\n  if (!isElement(node)) return;\n\n  if (data.tagName === 'meta' && !isAllowedMetaRefreshTag(node)) {\n    node.parentNode?.removeChild(node);\n  }\n};\n"],"names":[],"mappings":";;AAsBA,MAAM,uBAAA,GAA0B,CAAC,OAAA,KAA8B;AAC7D,EAAA,MAAM,SAAA,GAAY,OAAA,CAAQ,YAAA,CAAa,YAAY,CAAA;AACnD,EAAA,MAAM,OAAA,GAAU,OAAA,CAAQ,YAAA,CAAa,SAAS,CAAA;AAE9C,EAAA,OAAO,SAAA,KAAc,SAAA,IAAa,OAAA,EAAS,QAAA,CAAS,MAAM,CAAA,KAAM,IAAA;AAClE,CAAA;AAOO,MAAM,oBAAA,GAAgD,CAAC,IAAA,EAAM,IAAA,KAAS;AAC3E,EAAA,IAAI,CAAC,SAAA,CAAU,IAAI,CAAA,EAAG;AAEtB,EAAA,IAAI,KAAK,OAAA,KAAY,MAAA,IAAU,CAAC,uBAAA,CAAwB,IAAI,CAAA,EAAG;AAC7D,IAAA,IAAA,CAAK,UAAA,EAAY,YAAY,IAAI,CAAA;AAAA,EACnC;AACF;;;;"}