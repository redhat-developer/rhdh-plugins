{"version":3,"file":"copyToClipboard.esm.js","sources":["../../../src/reader/transformers/copyToClipboard.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useCallback } from 'react';\nimport { renderReactElement } from './renderReactElement';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { withStyles, Theme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport type { Transformer } from './transformer';\nimport useCopyToClipboard from 'react-use/esm/useCopyToClipboard';\n\nconst CopyToClipboardTooltip = withStyles(theme => ({\n  tooltip: {\n    fontSize: 'inherit',\n    color: theme.palette.text.primary,\n    margin: 0,\n    padding: theme.spacing(0.5),\n    backgroundColor: 'transparent',\n    boxShadow: 'none',\n  },\n}))(Tooltip);\n\nconst CopyToClipboardIcon = () => (\n  <SvgIcon>\n    <path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\" />\n  </SvgIcon>\n);\n\ntype CopyToClipboardButtonProps = {\n  text: string;\n};\n\nconst CopyToClipboardButton = ({ text }: CopyToClipboardButtonProps) => {\n  const [open, setOpen] = useState(false);\n  const [, copyToClipboard] = useCopyToClipboard();\n\n  const handleClick = useCallback(() => {\n    copyToClipboard(text);\n    setOpen(true);\n  }, [text, copyToClipboard]);\n\n  const handleClose = useCallback(() => {\n    setOpen(false);\n  }, [setOpen]);\n\n  return (\n    <CopyToClipboardTooltip\n      title=\"Copied to clipboard\"\n      placement=\"left\"\n      open={open}\n      onClose={handleClose}\n      leaveDelay={1000}\n    >\n      <IconButton\n        style={{ position: 'absolute' }}\n        className=\"md-clipboard md-icon\"\n        onClick={handleClick}\n        aria-label=\"Copy to clipboard\"\n      >\n        <CopyToClipboardIcon />\n      </IconButton>\n    </CopyToClipboardTooltip>\n  );\n};\n\n/**\n * Recreates copy-to-clipboard functionality attached to <code> snippets that\n * is native to mkdocs-material theme.\n */\nexport const copyToClipboard = (theme: Theme): Transformer => {\n  return dom => {\n    const codes = dom.querySelectorAll('pre > code');\n    for (const code of codes) {\n      const text = code.textContent || '';\n      const container = document.createElement('div');\n      code?.parentElement?.prepend(container);\n      renderReactElement(\n        <ThemeProvider theme={theme}>\n          <CopyToClipboardButton text={text} />\n        </ThemeProvider>,\n        container,\n      );\n    }\n    return dom;\n  };\n};\n"],"names":["copyToClipboard"],"mappings":";;;;;;;;;AA0BA,MAAM,sBAAA,GAAyB,WAAW,CAAA,KAAA,MAAU;AAAA,EAClD,OAAA,EAAS;AAAA,IACP,QAAA,EAAU,SAAA;AAAA,IACV,KAAA,EAAO,KAAA,CAAM,OAAA,CAAQ,IAAA,CAAK,OAAA;AAAA,IAC1B,MAAA,EAAQ,CAAA;AAAA,IACR,OAAA,EAAS,KAAA,CAAM,OAAA,CAAQ,GAAG,CAAA;AAAA,IAC1B,eAAA,EAAiB,aAAA;AAAA,IACjB,SAAA,EAAW;AAAA;AAEf,CAAA,CAAE,EAAE,OAAO,CAAA;AAEX,MAAM,mBAAA,GAAsB,sBAC1B,GAAA,CAAC,OAAA,EAAA,EACC,8BAAC,MAAA,EAAA,EAAK,CAAA,EAAE,mIAAkI,CAAA,EAC5I,CAAA;AAOF,MAAM,qBAAA,GAAwB,CAAC,EAAE,IAAA,EAAK,KAAkC;AACtE,EAAA,MAAM,CAAC,IAAA,EAAM,OAAO,CAAA,GAAI,SAAS,KAAK,CAAA;AACtC,EAAA,MAAM,GAAGA,gBAAe,CAAA,GAAI,kBAAA,EAAmB;AAE/C,EAAA,MAAM,WAAA,GAAc,YAAY,MAAM;AACpC,IAAAA,iBAAgB,IAAI,CAAA;AACpB,IAAA,OAAA,CAAQ,IAAI,CAAA;AAAA,EACd,CAAA,EAAG,CAAC,IAAA,EAAMA,gBAAe,CAAC,CAAA;AAE1B,EAAA,MAAM,WAAA,GAAc,YAAY,MAAM;AACpC,IAAA,OAAA,CAAQ,KAAK,CAAA;AAAA,EACf,CAAA,EAAG,CAAC,OAAO,CAAC,CAAA;AAEZ,EAAA,uBACE,GAAA;AAAA,IAAC,sBAAA;AAAA,IAAA;AAAA,MACC,KAAA,EAAM,qBAAA;AAAA,MACN,SAAA,EAAU,MAAA;AAAA,MACV,IAAA;AAAA,MACA,OAAA,EAAS,WAAA;AAAA,MACT,UAAA,EAAY,GAAA;AAAA,MAEZ,QAAA,kBAAA,GAAA;AAAA,QAAC,UAAA;AAAA,QAAA;AAAA,UACC,KAAA,EAAO,EAAE,QAAA,EAAU,UAAA,EAAW;AAAA,UAC9B,SAAA,EAAU,sBAAA;AAAA,UACV,OAAA,EAAS,WAAA;AAAA,UACT,YAAA,EAAW,mBAAA;AAAA,UAEX,8BAAC,mBAAA,EAAA,EAAoB;AAAA;AAAA;AACvB;AAAA,GACF;AAEJ,CAAA;AAMO,MAAM,eAAA,GAAkB,CAAC,KAAA,KAA8B;AAC5D,EAAA,OAAO,CAAA,GAAA,KAAO;AACZ,IAAA,MAAM,KAAA,GAAQ,GAAA,CAAI,gBAAA,CAAiB,YAAY,CAAA;AAC/C,IAAA,KAAA,MAAW,QAAQ,KAAA,EAAO;AACxB,MAAA,MAAM,IAAA,GAAO,KAAK,WAAA,IAAe,EAAA;AACjC,MAAA,MAAM,SAAA,GAAY,QAAA,CAAS,aAAA,CAAc,KAAK,CAAA;AAC9C,MAAA,IAAA,EAAM,aAAA,EAAe,QAAQ,SAAS,CAAA;AACtC,MAAA,kBAAA;AAAA,4BACG,aAAA,EAAA,EAAc,KAAA,EACb,QAAA,kBAAA,GAAA,CAAC,qBAAA,EAAA,EAAsB,MAAY,CAAA,EACrC,CAAA;AAAA,QACA;AAAA,OACF;AAAA,IACF;AACA,IAAA,OAAO,GAAA;AAAA,EACT,CAAA;AACF;;;;"}