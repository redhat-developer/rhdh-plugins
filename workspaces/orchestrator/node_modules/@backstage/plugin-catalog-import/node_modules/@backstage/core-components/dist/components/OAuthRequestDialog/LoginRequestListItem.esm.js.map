{"version":3,"file":"LoginRequestListItem.esm.js","sources":["../../../src/components/OAuthRequestDialog/LoginRequestListItem.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport { useState } from 'react';\nimport { isError } from '@backstage/errors';\nimport {\n  configApiRef,\n  PendingOAuthRequest,\n  useApi,\n} from '@backstage/core-plugin-api';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\nimport Box from '@material-ui/core/Box';\n\nexport type LoginRequestListItemClassKey = 'root';\n\nconst useItemStyles = makeStyles(\n  theme => ({\n    root: {\n      paddingLeft: theme.spacing(2),\n    },\n    button: {\n      marginLeft: theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageLoginRequestListItem' },\n);\n\ntype RowProps = {\n  request: PendingOAuthRequest;\n  busy: boolean;\n  setBusy: (busy: boolean) => void;\n};\n\nconst LoginRequestListItem = ({ request, busy, setBusy }: RowProps) => {\n  const classes = useItemStyles();\n  const [error, setError] = useState<string>();\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n  const configApi = useApi(configApiRef);\n\n  const handleContinue = async () => {\n    setBusy(true);\n    try {\n      await request.trigger();\n    } catch (e) {\n      setError(isError(e) ? e.message : 'An unspecified error occurred');\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  const IconComponent = request.provider.icon;\n  const message =\n    request.provider.message ??\n    t('oauthRequestDialog.message', {\n      appTitle: configApi.getString('app.title'),\n      provider: request.provider.title,\n    });\n\n  return (\n    <ListItem disabled={busy} classes={{ root: classes.root }}>\n      <ListItemAvatar>\n        <IconComponent fontSize=\"large\" />\n      </ListItemAvatar>\n      <Box display=\"flex\" alignItems=\"center\" flex={1}>\n        <Box flex={1}>\n          <ListItemText\n            primary={request.provider.title}\n            secondary={\n              <>\n                {message && (\n                  <Typography variant=\"subtitle2\" color=\"textSecondary\">\n                    {message}\n                  </Typography>\n                )}\n                {error && <Typography color=\"error\">{error}</Typography>}\n              </>\n            }\n          />\n        </Box>\n        <Button\n          color=\"primary\"\n          variant=\"contained\"\n          onClick={handleContinue}\n          className={classes.button}\n        >\n          {t('oauthRequestDialog.login')}\n        </Button>\n      </Box>\n    </ListItem>\n  );\n};\n\nexport default LoginRequestListItem;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAmCA,MAAM,aAAA,GAAgB,UAAA;AAAA,EACpB,CAAA,KAAA,MAAU;AAAA,IACR,IAAA,EAAM;AAAA,MACJ,WAAA,EAAa,KAAA,CAAM,OAAA,CAAQ,CAAC;AAAA,KAC9B;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,UAAA,EAAY,KAAA,CAAM,OAAA,CAAQ,CAAC;AAAA;AAC7B,GACF,CAAA;AAAA,EACA,EAAE,MAAM,+BAAA;AACV,CAAA;AAQA,MAAM,uBAAuB,CAAC,EAAE,OAAA,EAAS,IAAA,EAAM,SAAQ,KAAgB;AACrE,EAAA,MAAM,UAAU,aAAA,EAAc;AAC9B,EAAA,MAAM,CAAC,KAAA,EAAO,QAAQ,CAAA,GAAI,QAAA,EAAiB;AAC3C,EAAA,MAAM,EAAE,CAAA,EAAE,GAAI,iBAAA,CAAkB,4BAA4B,CAAA;AAC5D,EAAA,MAAM,SAAA,GAAY,OAAO,YAAY,CAAA;AAErC,EAAA,MAAM,iBAAiB,YAAY;AACjC,IAAA,OAAA,CAAQ,IAAI,CAAA;AACZ,IAAA,IAAI;AACF,MAAA,MAAM,QAAQ,OAAA,EAAQ;AAAA,IACxB,SAAS,CAAA,EAAG;AACV,MAAA,QAAA,CAAS,OAAA,CAAQ,CAAC,CAAA,GAAI,CAAA,CAAE,UAAU,+BAA+B,CAAA;AAAA,IACnE,CAAA,SAAE;AACA,MAAA,OAAA,CAAQ,KAAK,CAAA;AAAA,IACf;AAAA,EACF,CAAA;AAEA,EAAA,MAAM,aAAA,GAAgB,QAAQ,QAAA,CAAS,IAAA;AACvC,EAAA,MAAM,OAAA,GACJ,OAAA,CAAQ,QAAA,CAAS,OAAA,IACjB,EAAE,4BAAA,EAA8B;AAAA,IAC9B,QAAA,EAAU,SAAA,CAAU,SAAA,CAAU,WAAW,CAAA;AAAA,IACzC,QAAA,EAAU,QAAQ,QAAA,CAAS;AAAA,GAC5B,CAAA;AAEH,EAAA,uBACE,IAAA,CAAC,YAAS,QAAA,EAAU,IAAA,EAAM,SAAS,EAAE,IAAA,EAAM,OAAA,CAAQ,IAAA,EAAK,EACtD,QAAA,EAAA;AAAA,oBAAA,GAAA,CAAC,cAAA,EAAA,EACC,QAAA,kBAAA,GAAA,CAAC,aAAA,EAAA,EAAc,QAAA,EAAS,SAAQ,CAAA,EAClC,CAAA;AAAA,yBACC,GAAA,EAAA,EAAI,OAAA,EAAQ,QAAO,UAAA,EAAW,QAAA,EAAS,MAAM,CAAA,EAC5C,QAAA,EAAA;AAAA,sBAAA,GAAA,CAAC,GAAA,EAAA,EAAI,MAAM,CAAA,EACT,QAAA,kBAAA,GAAA;AAAA,QAAC,YAAA;AAAA,QAAA;AAAA,UACC,OAAA,EAAS,QAAQ,QAAA,CAAS,KAAA;AAAA,UAC1B,2BACE,IAAA,CAAA,QAAA,EAAA,EACG,QAAA,EAAA;AAAA,YAAA,OAAA,wBACE,UAAA,EAAA,EAAW,OAAA,EAAQ,WAAA,EAAY,KAAA,EAAM,iBACnC,QAAA,EAAA,OAAA,EACH,CAAA;AAAA,YAED,KAAA,oBAAS,GAAA,CAAC,UAAA,EAAA,EAAW,KAAA,EAAM,SAAS,QAAA,EAAA,KAAA,EAAM;AAAA,WAAA,EAC7C;AAAA;AAAA,OAEJ,EACF,CAAA;AAAA,sBACA,GAAA;AAAA,QAAC,MAAA;AAAA,QAAA;AAAA,UACC,KAAA,EAAM,SAAA;AAAA,UACN,OAAA,EAAQ,WAAA;AAAA,UACR,OAAA,EAAS,cAAA;AAAA,UACT,WAAW,OAAA,CAAQ,MAAA;AAAA,UAElB,YAAE,0BAA0B;AAAA;AAAA;AAC/B,KAAA,EACF;AAAA,GAAA,EACF,CAAA;AAEJ;;;;"}