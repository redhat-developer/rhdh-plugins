{"version":3,"file":"HorizontalScrollGrid.esm.js","sources":["../../../src/components/HorizontalScrollGrid/HorizontalScrollGrid.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport classNames from 'classnames';\nimport {\n  MutableRefObject,\n  useState,\n  useLayoutEffect,\n  useRef,\n  PropsWithChildren,\n} from 'react';\n\nconst generateGradientStops = (themeType: 'dark' | 'light') => {\n  // 97% corresponds to the theme.palette.background.default for the light theme\n  // 16% for the dark theme\n  const luminance = themeType === 'dark' ? '16%' : '97%';\n  // Generated with https://larsenwork.com/easing-gradients/\n  return `\n    hsl(0, 0%, ${luminance}) 0%,\n    hsla(0, 0%, ${luminance}, 0.987) 8.1%,\n    hsla(0, 0%, ${luminance}, 0.951) 15.5%,\n    hsla(0, 0%, ${luminance}, 0.896) 22.5%,\n    hsla(0, 0%, ${luminance}, 0.825) 29%,\n    hsla(0, 0%, ${luminance}, 0.741) 35.3%,\n    hsla(0, 0%, ${luminance}, 0.648) 41.2%,\n    hsla(0, 0%, ${luminance}, 0.55) 47.1%,\n    hsla(0, 0%, ${luminance}, 0.45) 52.9%,\n    hsla(0, 0%, ${luminance}, 0.352) 58.8%,\n    hsla(0, 0%, ${luminance}, 0.259) 64.7%,\n    hsla(0, 0%, ${luminance}, 0.175) 71%,\n    hsla(0, 0%, ${luminance}, 0.104) 77.5%,\n    hsla(0, 0%, ${luminance}, 0.049) 84.5%,\n    hsla(0, 0%, ${luminance}, 0.013) 91.9%,\n    hsla(0, 0%, ${luminance}, 0) 100%\n  `;\n};\n\nconst fadeSize = 100;\nconst fadePadding = 10;\n\ntype Props = {\n  scrollStep?: number;\n  scrollSpeed?: number; // lower is faster\n  minScrollDistance?: number; // limits how small steps the scroll can take in px\n};\n\n/** @public */\nexport type HorizontalScrollGridClassKey =\n  | 'root'\n  | 'container'\n  | 'fade'\n  | 'fadeLeft'\n  | 'fadeRight'\n  | 'fadeHidden'\n  | 'button'\n  | 'buttonLeft'\n  | 'buttonRight';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      position: 'relative',\n      display: 'flex',\n      flexFlow: 'row nowrap',\n      alignItems: 'center',\n    },\n    container: {\n      overflow: 'auto',\n      scrollbarWidth: 0 as any, // hide in FF\n      '&::-webkit-scrollbar': {\n        display: 'none', // hide in Chrome\n      },\n    },\n    fade: {\n      position: 'absolute',\n      width: fadeSize,\n      height: `calc(100% + ${fadePadding}px)`,\n      transition: 'opacity 300ms',\n      pointerEvents: 'none',\n    },\n    fadeLeft: {\n      left: -fadePadding,\n      background: `linear-gradient(90deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeRight: {\n      right: -fadePadding,\n      background: `linear-gradient(270deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeHidden: {\n      opacity: 0,\n    },\n    button: {\n      position: 'absolute',\n    },\n    buttonLeft: {\n      left: -theme.spacing(2),\n    },\n    buttonRight: {\n      right: -theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageHorizontalScrollGrid' },\n);\n\n// Returns scroll distance from left and right\nfunction useScrollDistance(\n  ref: MutableRefObject<HTMLElement | undefined>,\n): [number, number] {\n  const [[scrollLeft, scrollRight], setScroll] = useState<[number, number]>([\n    0, 0,\n  ]);\n\n  useLayoutEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      setScroll([0, 0]);\n      return;\n    }\n\n    const handleUpdate = () => {\n      const left = el.scrollLeft;\n      const right = el.scrollWidth - el.offsetWidth - el.scrollLeft;\n      setScroll([left, right]);\n    };\n\n    handleUpdate();\n\n    el.addEventListener('scroll', handleUpdate);\n    window.addEventListener('resize', handleUpdate);\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => {\n      el.removeEventListener('scroll', handleUpdate);\n      window.removeEventListener('resize', handleUpdate);\n    };\n  }, [ref]);\n\n  return [scrollLeft, scrollRight];\n}\n\n// Used to animate scrolling. Returns a single setScrollTarget function, when called with e.g. 200,\n// the element pointer to by the ref will be scrolled 200px forwards over time.\nfunction useSmoothScroll(\n  ref: MutableRefObject<HTMLElement | undefined>,\n  speed: number,\n  minDistance: number,\n) {\n  const [scrollTarget, setScrollTarget] = useState<number>(0);\n\n  useLayoutEffect(() => {\n    if (scrollTarget === 0) {\n      return;\n    }\n\n    const startTime = window.performance.now();\n    const id = requestAnimationFrame(frameTime => {\n      if (!ref.current) {\n        return;\n      }\n      const frameDuration = frameTime - startTime;\n      const scrollDistance = (Math.abs(scrollTarget) * frameDuration) / speed;\n      const cappedScrollDistance = Math.max(minDistance, scrollDistance);\n      const scrollAmount = cappedScrollDistance * Math.sign(scrollTarget);\n\n      ref.current.scrollBy({ left: scrollAmount });\n\n      const newScrollTarget = scrollTarget - scrollAmount;\n      if (Math.sign(scrollTarget) !== Math.sign(newScrollTarget)) {\n        setScrollTarget(0);\n      } else {\n        setScrollTarget(newScrollTarget);\n      }\n    });\n\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => cancelAnimationFrame(id);\n  }, [ref, scrollTarget, speed, minDistance]);\n\n  return setScrollTarget;\n}\n\n/**\n * Horizontal scrollable component with arrows to navigate\n *\n * @public\n *\n */\nexport function HorizontalScrollGrid(props: PropsWithChildren<Props>) {\n  const {\n    scrollStep = 100,\n    scrollSpeed = 50,\n    minScrollDistance = 5,\n    children,\n    ...otherProps\n  } = props;\n  const classes = useStyles(props);\n  const ref = useRef<HTMLElement>();\n\n  const [scrollLeft, scrollRight] = useScrollDistance(ref);\n  const setScrollTarget = useSmoothScroll(ref, scrollSpeed, minScrollDistance);\n\n  const handleScrollClick = (forwards: boolean) => {\n    const el = ref.current;\n    if (!el) {\n      return;\n    }\n    setScrollTarget(forwards ? scrollStep : -scrollStep);\n  };\n\n  return (\n    <Box {...otherProps} className={classes.root}>\n      <Grid\n        container\n        direction=\"row\"\n        wrap=\"nowrap\"\n        className={classes.container}\n        ref={ref as any}\n      >\n        {children}\n      </Grid>\n      <Box\n        className={classNames(classes.fade, classes.fadeLeft, {\n          [classes.fadeHidden]: scrollLeft === 0,\n        })}\n      />\n      <Box\n        className={classNames(classes.fade, classes.fadeRight, {\n          [classes.fadeHidden]: scrollRight === 0,\n        })}\n      />\n      {scrollLeft > 0 && (\n        <IconButton\n          title=\"Scroll Left\"\n          onClick={() => handleScrollClick(false)}\n          className={classNames(classes.button, classes.buttonLeft, {})}\n        >\n          <ChevronLeftIcon />\n        </IconButton>\n      )}\n      {scrollRight > 0 && (\n        <IconButton\n          title=\"Scroll Right\"\n          onClick={() => handleScrollClick(true)}\n          className={classNames(classes.button, classes.buttonRight, {})}\n        >\n          <ChevronRightIcon />\n        </IconButton>\n      )}\n    </Box>\n  );\n}\n"],"names":["ChevronRightIcon"],"mappings":"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"}